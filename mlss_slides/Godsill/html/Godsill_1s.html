<!DOCTYPE html><html>
<head>
<title></title>
<style type="text/css">
<!--
.xflip {
    -moz-transform: scaleX(-1);
    -webkit-transform: scaleX(-1);
    -o-transform: scaleX(-1);
    transform: scaleX(-1);
    filter: fliph;
}
.yflip {
    -moz-transform: scaleY(-1);
    -webkit-transform: scaleY(-1);
    -o-transform: scaleY(-1);
    transform: scaleY(-1);
    filter: flipv;
}
.xyflip {
    -moz-transform: scaleX(-1) scaleY(-1);
    -webkit-transform: scaleX(-1) scaleY(-1);
    -o-transform: scaleX(-1) scaleY(-1);
    transform: scaleX(-1) scaleY(-1);
    filter: fliph + flipv;
}
-->
</style>
</head>
<body>
<a name=1></a><img src="./Godsill_1-1_1.jpg"/><br/>
<img src="./Godsill_1-1_2.jpg"/><br/>
<img src="./Godsill_1-1_3.jpg"/><br/>
Sequential&#160;Monte&#160;Carlo&#160;Methods<br/>
Simon&#160;Godsill&#160;www-sigproc.eng.cam.ac.uk/~sjg<br/>
Cambridge,&#160;September,&#160;2009<br/>
University&#160;of&#160;Cambridge<br/>
1<br/>
<hr/>
<a name=2></a>Overview<br/>
•&#160;We&#160;are&#160;faced&#160;with&#160;many&#160;problems&#160;involving&#160;large,&#160;sequentially&#160;evolving<br/>
datasets:<br/>
tracking,&#160;computer&#160;vision,&#160;speech&#160;and&#160;audio,&#160;robotics,&#160;financial&#160;time<br/>
series,&#160;....<br/>
•&#160;We&#160;wish&#160;to&#160;form&#160;models&#160;and&#160;algorithms&#160;for&#160;Bayesian&#160;sequential<br/>
updating&#160;of&#160;probability&#160;distributions&#160;as&#160;data&#160;evolve<br/>
•&#160;Here&#160;we&#160;consider&#160;the&#160;Sequential&#160;Monte&#160;Carlo&#160;(SMC),&#160;or&#160;‘particle<br/>
filtering’&#160;methodology&#160;(Gordon,&#160;Salmond&#160;and&#160;Smith&#160;IEE&#160;(93),&#160;Doucet,<br/>
Godsill&#160;and&#160;Andrieu&#160;Stats.&#160;and&#160;Comp.&#160;(2000),&#160;Capp´<br/>
e,&#160;Godsill&#160;and<br/>
Moulines&#160;Proc.&#160;IEEE&#160;(2007),&#160;and&#160;many&#160;more&#160;...)<br/>
2<br/>
<hr/>
<a name=3></a>In&#160;many&#160;applications&#160;it&#160;is&#160;required&#160;to&#160;estimate&#160;a&#160;latent&#160;or&#160;‘hidden’&#160;process<br/>
(the&#160;‘state’&#160;of&#160;the&#160;system)&#160;from&#160;noisy,&#160;convolved&#160;or&#160;non-linearly&#160;distorted<br/>
observations.&#160;Since&#160;data&#160;also&#160;arrive&#160;sequentially&#160;in&#160;many&#160;applications&#160;it&#160;is<br/>
therefore&#160;desirable&#160;(or&#160;essential)&#160;to&#160;estimate&#160;the&#160;hidden&#160;process&#160;on-line,&#160;in<br/>
order&#160;to&#160;avoid&#160;memory&#160;storage&#160;of&#160;huge&#160;datasets&#160;and&#160;to&#160;make&#160;inferences&#160;and<br/>
decisions&#160;in&#160;real&#160;time.&#160;Some&#160;typical&#160;applications&#160;from&#160;the&#160;engineering<br/>
perspective&#160;include:<br/>
•&#160;Tracking&#160;for&#160;radar&#160;and&#160;sonar&#160;applications<br/>
•&#160;Real-time&#160;enhancement&#160;of&#160;speech&#160;and&#160;audio&#160;signals<br/>
•&#160;Sequence&#160;and&#160;channel&#160;estimation&#160;in&#160;digital&#160;communications&#160;channels<br/>
•&#160;Medical&#160;monitoring&#160;of&#160;patient&#160;eeg/ecg&#160;signals<br/>
•&#160;Image&#160;sequence&#160;tracking<br/>
In&#160;this&#160;tutorial&#160;we&#160;will&#160;consider&#160;sequential&#160;estimation&#160;in&#160;such&#160;applications.<br/>
3<br/>
<hr/>
<a name=4></a>Only&#160;when&#160;the&#160;system&#160;is&#160;linear&#160;and&#160;Gaussian&#160;can&#160;exact&#160;estimation&#160;be<br/>
performed,&#160;using&#160;the&#160;classical&#160;Kalman&#160;filter.&#160;I&#160;will&#160;present&#160;a&#160;succinct<br/>
derivation&#160;of&#160;the&#160;Kalman&#160;filter,&#160;based&#160;on&#160;Bayesian&#160;updating&#160;of&#160;probability<br/>
models.&#160;In&#160;most&#160;applications,&#160;however,&#160;there&#160;are&#160;elements&#160;of<br/>
non-Gaussianity&#160;and/or&#160;non-linearity&#160;which&#160;make&#160;analytical&#160;computations<br/>
impossible.&#160;Here&#160;we&#160;must&#160;adopt&#160;numerical&#160;strategies.&#160;I&#160;will&#160;consider&#160;a<br/>
powerful&#160;class&#160;of&#160;Monte&#160;Carlo&#160;filters,&#160;known&#160;generically&#160;as&#160;particle&#160;filters,<br/>
which&#160;are&#160;well-adapted&#160;to&#160;general&#160;problems&#160;in&#160;this&#160;category.<br/>
4<br/>
<hr/>
<a name=5></a>Contents<br/>
Today:<br/>
•&#160;Bayes’&#160;Theorem<br/>
•&#160;Monte&#160;Carlo&#160;methods<br/>
•&#160;State&#160;space&#160;models,&#160;filtering&#160;and&#160;smoothing<br/>
•&#160;Kalman&#160;filter/&#160;extended&#160;Kalman&#160;filter<br/>
•&#160;Monte&#160;Carlo&#160;filtering<br/>
•&#160;Sequential&#160;Monte&#160;Carlo&#160;(bootstrap)<br/>
•&#160;General&#160;Sequential&#160;Importance&#160;Sampling<br/>
Tomorrow:<br/>
Other&#160;exotica&#160;(auxiliary&#160;particle&#160;filter,&#160;smoothing,&#160;Rao-Blackwell,&#160;MCMC,<br/>
etc...).<br/>
5<br/>
<hr/>
<a name=6></a>Bayes’&#160;Theorem&#160;and&#160;inference<br/>
Observations:&#160;y<br/>
Quantity&#160;of&#160;interest:&#160;x<br/>
Other&#160;parameters/unknowns:&#160;θ<br/>
Likelihood:<br/>
p(&#160;y&#160;|&#160;x,&#160;θ&#160;)<br/>
Joint&#160;posterior&#160;for&#160;all&#160;unknowns&#160;(Bayes’&#160;Theorem):<br/>
p(&#160;y&#160;|&#160;x,&#160;θ&#160;)&#160;p(&#160;x,&#160;θ&#160;)<br/>
p(&#160;x,&#160;θ&#160;|&#160;y&#160;)&#160;=<br/>
p(y)<br/>
Marginal&#160;posterior&#160;for&#160;x:<br/>
Z<br/>
p(&#160;x&#160;|&#160;y&#160;)&#160;=<br/>
p(&#160;x,&#160;θ&#160;|&#160;y&#160;)&#160;dθ<br/>
θ<br/>
Marginal&#160;posterior&#160;is&#160;used&#160;for&#160;inference&#160;about&#160;the&#160;quantity&#160;of&#160;interest,&#160;x.<br/>
6<br/>
<hr/>
<a name=7></a><img src="./Godsill_1-7_1.jpg"/><br/>
<img src="./Godsill_1-7_2.jpg"/><br/>
Monte&#160;Carlo&#160;Methods<br/>
7<br/>
<hr/>
<a name=8></a><img src="./Godsill_1-8_1.jpg"/><br/>
<img src="./Godsill_1-8_2.jpg"/><br/>
Monte&#160;Carlo&#160;Methods<br/>
In&#160;the&#160;Monte&#160;Carlo&#160;method,&#160;we&#160;are&#160;concerned&#160;here&#160;with&#160;estimating&#160;the<br/>
properties&#160;of&#160;some&#160;highly&#160;complex&#160;probability&#160;distribution&#160;p(x),&#160;e.g.<br/>
expectations:<br/>
Z<br/>
EX&#160;=<br/>
h(x)p(x)dx<br/>
where&#160;h(.)&#160;is&#160;some&#160;useful&#160;function&#160;for&#160;estimation.<br/>
7<br/>
<hr/>
<a name=9></a>In&#160;cases&#160;where&#160;this&#160;cannot&#160;be&#160;achieved&#160;analytically&#160;the&#160;approximation<br/>
problem&#160;can&#160;be&#160;tackled&#160;indirectly,&#160;as&#160;it&#160;is&#160;often&#160;possible&#160;to&#160;generate&#160;random<br/>
samples&#160;from&#160;p(x),&#160;i.e.&#160;by&#160;representing&#160;the&#160;distribution&#160;as&#160;a&#160;collection&#160;of<br/>
random&#160;points:<br/>
x(i),&#160;i&#160;=&#160;1,&#160;...,&#160;N&#160;,&#160;for&#160;large&#160;N<br/>
8<br/>
<hr/>
<a name=10></a>In&#160;cases&#160;where&#160;this&#160;cannot&#160;be&#160;achieved&#160;analytically&#160;the&#160;approximation<br/>
problem&#160;can&#160;be&#160;tackled&#160;indirectly,&#160;as&#160;it&#160;is&#160;often&#160;possible&#160;to&#160;generate&#160;random<br/>
samples&#160;from&#160;p(x),&#160;i.e.&#160;by&#160;representing&#160;the&#160;distribution&#160;as&#160;a&#160;collection&#160;of<br/>
random&#160;points:<br/>
x(i),&#160;i&#160;=&#160;1,&#160;...,&#160;N&#160;,&#160;for&#160;large&#160;N<br/>
We&#160;can&#160;think&#160;of&#160;the&#160;Monte&#160;Carlo&#160;representation&#160;informally&#160;as:<br/>
N<br/>
1&#160;X<br/>
p(x)&#160;≈<br/>
δ<br/>
N<br/>
x(i)&#160;(x)<br/>
i=1<br/>
8<br/>
<hr/>
<a name=11></a>In&#160;cases&#160;where&#160;this&#160;cannot&#160;be&#160;achieved&#160;analytically&#160;the&#160;approximation<br/>
problem&#160;can&#160;be&#160;tackled&#160;indirectly,&#160;as&#160;it&#160;is&#160;often&#160;possible&#160;to&#160;generate&#160;random<br/>
samples&#160;from&#160;p(x),&#160;i.e.&#160;by&#160;representing&#160;the&#160;distribution&#160;as&#160;a&#160;collection&#160;of<br/>
random&#160;points:<br/>
x(i),&#160;i&#160;=&#160;1,&#160;...,&#160;N&#160;,&#160;for&#160;large&#160;N<br/>
We&#160;can&#160;think&#160;of&#160;the&#160;Monte&#160;Carlo&#160;representation&#160;informally&#160;as:<br/>
N<br/>
1&#160;X<br/>
p(x)&#160;≈<br/>
δ<br/>
N<br/>
x(i)&#160;(x)<br/>
i=1<br/>
Then&#160;the&#160;Monte&#160;Carlo&#160;expectation&#160;falls&#160;out&#160;easily&#160;as:<br/>
N<br/>
N<br/>
Z<br/>
Z<br/>
1&#160;X<br/>
1&#160;X<br/>
EX&#160;=<br/>
h(x)p(x)dx&#160;≈<br/>
h(x)<br/>
δ<br/>
h(x(i))<br/>
N<br/>
x(i)&#160;(x)dx&#160;=&#160;N<br/>
i=1<br/>
i=1<br/>
8<br/>
<hr/>
<a name=12></a>Alternatively,&#160;suppose&#160;we&#160;draw&#160;the&#160;random&#160;samples&#160;x(i)&#160;from&#160;a&#160;distribution<br/>
q(x)&#160;instead&#160;of&#160;p(x).&#160;Now&#160;the&#160;expectation&#160;can&#160;be&#160;estimated&#160;using<br/>
importance&#160;sampling:<br/>
9<br/>
<hr/>
<a name=13></a>Alternatively,&#160;suppose&#160;we&#160;draw&#160;the&#160;random&#160;samples&#160;x(i)&#160;from&#160;a&#160;distribution<br/>
q(x)&#160;instead&#160;of&#160;p(x).&#160;Now&#160;the&#160;expectation&#160;can&#160;be&#160;estimated&#160;using<br/>
importance&#160;sampling:<br/>
N<br/>
Z<br/>
Z<br/>
q(x)p(x)<br/>
Z<br/>
p(x)&#160;1&#160;X<br/>
EX&#160;=<br/>
h(x)p(x)dx&#160;=<br/>
h(x)<br/>
dx&#160;≈<br/>
h(x)<br/>
δ<br/>
q(x)<br/>
q(x)&#160;N<br/>
x(i)&#160;(x)dx<br/>
i=1<br/>
N<br/>
N<br/>
1&#160;X&#160;p(x(i))<br/>
X<br/>
=<br/>
h(x(i))&#160;=<br/>
w(i)h(x(i))<br/>
N<br/>
q(x(i))<br/>
i=1<br/>
i=1<br/>
9<br/>
<hr/>
<a name=14></a>Alternatively,&#160;suppose&#160;we&#160;draw&#160;the&#160;random&#160;samples&#160;x(i)&#160;from&#160;a&#160;distribution<br/>
q(x)&#160;instead&#160;of&#160;p(x).&#160;Now&#160;the&#160;expectation&#160;can&#160;be&#160;estimated&#160;using<br/>
importance&#160;sampling:<br/>
N<br/>
Z<br/>
Z<br/>
q(x)p(x)<br/>
Z<br/>
p(x)&#160;1&#160;X<br/>
EX&#160;=<br/>
h(x)p(x)dx&#160;=<br/>
h(x)<br/>
dx&#160;≈<br/>
h(x)<br/>
δ<br/>
q(x)<br/>
q(x)&#160;N<br/>
x(i)&#160;(x)dx<br/>
i=1<br/>
N<br/>
N<br/>
1&#160;X&#160;p(x(i))<br/>
X<br/>
=<br/>
h(x(i))&#160;=<br/>
w(i)h(x(i))<br/>
N<br/>
q(x(i))<br/>
i=1<br/>
i=1<br/>
where&#160;w(i)&#160;∝&#160;p(x(i))&#160;is&#160;the&#160;importance&#160;weight&#160;and&#160;we&#160;can&#160;think&#160;informally&#160;of<br/>
q(x(i))<br/>
p(x)&#160;as<br/>
N<br/>
N<br/>
X<br/>
X<br/>
p(x)&#160;≈<br/>
w(i)δ<br/>
w(i)&#160;=&#160;1<br/>
x(i)&#160;(x),<br/>
i=1<br/>
i=1<br/>
9<br/>
<hr/>
<a name=15></a>There&#160;are&#160;numerous&#160;versions&#160;of&#160;Monte&#160;Carlo&#160;samplers,&#160;including&#160;Markov<br/>
chain&#160;Monte&#160;Carlo,&#160;simulated&#160;annealing,&#160;importance&#160;sampling,&#160;quasi-Monte<br/>
Carlo,&#160;...<br/>
10<br/>
<hr/>
<a name=16></a>There&#160;are&#160;numerous&#160;versions&#160;of&#160;Monte&#160;Carlo&#160;samplers,&#160;including&#160;Markov<br/>
chain&#160;Monte&#160;Carlo,&#160;simulated&#160;annealing,&#160;importance&#160;sampling,&#160;quasi-Monte<br/>
Carlo,&#160;...<br/>
Here&#160;we&#160;limit&#160;attention&#160;to&#160;Sequential&#160;Monte&#160;Carlo&#160;methods,&#160;which&#160;are<br/>
proving&#160;very&#160;successful&#160;for&#160;solving&#160;challenging&#160;state-space&#160;modelling<br/>
problems.<br/>
10<br/>
<hr/>
<a name=17></a>Important&#160;trick:&#160;Automatic&#160;marginalisation&#160;using&#160;Monte&#160;Carlo:<br/>
If<br/>
(x,&#160;θ)&#160;∼&#160;p(x,&#160;θ|y)<br/>
11<br/>
<hr/>
<a name=18></a>Important&#160;trick:&#160;Automatic&#160;marginalisation&#160;using&#160;Monte&#160;Carlo:<br/>
If<br/>
(x,&#160;θ)&#160;∼&#160;p(x,&#160;θ|y)<br/>
then<br/>
x&#160;∼&#160;p(x|y)<br/>
and<br/>
θ&#160;∼&#160;p(θ|y)<br/>
11<br/>
<hr/>
<a name=19></a>Important&#160;trick:&#160;Automatic&#160;marginalisation&#160;using&#160;Monte&#160;Carlo:<br/>
If<br/>
(x,&#160;θ)&#160;∼&#160;p(x,&#160;θ|y)<br/>
then<br/>
x&#160;∼&#160;p(x|y)<br/>
and<br/>
θ&#160;∼&#160;p(θ|y)<br/>
[Since<br/>
p(x,&#160;θ|y)&#160;=&#160;p(x|y)p(θ|x,&#160;y)&#160;=&#160;p(θ|y)p(x|θ|y)<br/>
]<br/>
11<br/>
<hr/>
<a name=20></a>State&#160;space&#160;models,&#160;filtering&#160;and&#160;smoothing<br/>
We&#160;will&#160;focus&#160;here&#160;on&#160;a&#160;broad&#160;and&#160;general&#160;class&#160;of&#160;models.&#160;Examples<br/>
include:<br/>
•&#160;Hidden&#160;Markov&#160;models<br/>
•&#160;Most&#160;standard&#160;time&#160;series&#160;models:&#160;AR,&#160;MA,&#160;ARMA,...<br/>
•&#160;Special&#160;models&#160;from&#160;tracking,&#160;computer&#160;vision,&#160;finance,<br/>
communications,&#160;bioinformatics,&#160;...<br/>
First&#160;define&#160;the&#160;notations&#160;used.&#160;We&#160;will&#160;consider&#160;a&#160;very&#160;general&#160;class&#160;of&#160;time<br/>
series&#160;models,&#160;the&#160;state&#160;space&#160;model.&#160;Almost&#160;all&#160;models&#160;of&#160;practical&#160;utility<br/>
can&#160;be&#160;represented&#160;within&#160;this&#160;category,&#160;using&#160;a&#160;state&#160;vector&#160;of&#160;finite<br/>
dimension.&#160;The&#160;sequential&#160;inference&#160;methods&#160;presented&#160;can&#160;readily&#160;be<br/>
extended&#160;beyond&#160;the&#160;Markovian&#160;state&#160;space&#160;models&#160;given&#160;here,&#160;but&#160;for<br/>
simplicity&#160;we&#160;retain&#160;the&#160;standard&#160;Markovian&#160;setup.<br/>
12<br/>
<hr/>
<a name=21></a>Note:&#160;from&#160;here&#160;on&#160;column&#160;vectors&#160;are&#160;denoted&#160;in&#160;standard&#160;typeface,&#160;e.g.<br/>
xt,&#160;and&#160;matrices&#160;are&#160;denoted&#160;by&#160;capitals,&#160;e.g.&#160;B.&#160;This&#160;avoids&#160;some<br/>cumbersome&#160;heavy&#160;typeface&#160;notations.<br/>
•&#160;Consider&#160;a&#160;time&#160;series&#160;with&#160;states&#160;xt,&#160;t&#160;∈&#160;{0,&#160;2,&#160;...,&#160;T&#160;}.<br/>
13<br/>
<hr/>
<a name=22></a>Note:&#160;from&#160;here&#160;on&#160;column&#160;vectors&#160;are&#160;denoted&#160;in&#160;standard&#160;typeface,&#160;e.g.<br/>
xt,&#160;and&#160;matrices&#160;are&#160;denoted&#160;by&#160;capitals,&#160;e.g.&#160;B.&#160;This&#160;avoids&#160;some<br/>cumbersome&#160;heavy&#160;typeface&#160;notations.<br/>
•&#160;Consider&#160;a&#160;time&#160;series&#160;with&#160;states&#160;xt,&#160;t&#160;∈&#160;{0,&#160;2,&#160;...,&#160;T&#160;}.<br/>
•&#160;The&#160;states&#160;evolve&#160;in&#160;time&#160;according&#160;to&#160;a&#160;probability&#160;model.&#160;Assume&#160;a<br/>
Markov&#160;structure,&#160;i.e.<br/>
p(xt+1|x0,&#160;x1,&#160;...,&#160;xt)&#160;=&#160;f&#160;(xt+1|xt)<br/>
(1)<br/>
13<br/>
<hr/>
<a name=23></a>Note:&#160;from&#160;here&#160;on&#160;column&#160;vectors&#160;are&#160;denoted&#160;in&#160;standard&#160;typeface,&#160;e.g.<br/>
xt,&#160;and&#160;matrices&#160;are&#160;denoted&#160;by&#160;capitals,&#160;e.g.&#160;B.&#160;This&#160;avoids&#160;some<br/>cumbersome&#160;heavy&#160;typeface&#160;notations.<br/>
•&#160;Consider&#160;a&#160;time&#160;series&#160;with&#160;states&#160;xt,&#160;t&#160;∈&#160;{0,&#160;2,&#160;...,&#160;T&#160;}.<br/>
•&#160;The&#160;states&#160;evolve&#160;in&#160;time&#160;according&#160;to&#160;a&#160;probability&#160;model.&#160;Assume&#160;a<br/>
Markov&#160;structure,&#160;i.e.<br/>
p(xt+1|x0,&#160;x1,&#160;...,&#160;xt)&#160;=&#160;f&#160;(xt+1|xt)<br/>
(1)<br/>
•&#160;The&#160;states&#160;are&#160;‘partially’&#160;observed&#160;through&#160;a&#160;likelihood&#160;function&#160;for<br/>
observations&#160;{yt}&#160;which&#160;are&#160;assumed&#160;independent&#160;given&#160;the&#160;states,&#160;i.e.<br/>
p(yt+1|x0,&#160;x1,&#160;...,&#160;xt,&#160;xt+1,&#160;y0,&#160;y1,&#160;...,&#160;yt)&#160;=&#160;g(yt+1|xt+1)<br/>
(2)<br/>
13<br/>
<hr/>
<a name=24></a>Summarise&#160;as&#160;a&#160;‘state&#160;space’&#160;or&#160;‘dynamical’&#160;model:<br/>
xt+1∼f&#160;(xt+1|xt)<br/>
State&#160;evolution&#160;density<br/>
yt+1&#160;∼&#160;g(yt+1|xt+1)<br/>
Observation&#160;density<br/>
(3)<br/>
14<br/>
<hr/>
<a name=25></a>Summarise&#160;as&#160;a&#160;‘state&#160;space’&#160;or&#160;‘dynamical’&#160;model:<br/>
xt+1∼f&#160;(xt+1|xt)<br/>
State&#160;evolution&#160;density<br/>
yt+1&#160;∼&#160;g(yt+1|xt+1)<br/>
Observation&#160;density<br/>
(3)<br/>
Joint&#160;density&#160;can&#160;be&#160;expressed&#160;using&#160;the&#160;probability&#160;chain&#160;rule:<br/>
t<br/>
t<br/>
Y<br/>
Y<br/>
p&#160;(x0:t,&#160;y0:t)&#160;=&#160;f&#160;(x0)<br/>
f&#160;(xt|xt−1)<br/>
g(yt|xt)<br/>
i=1<br/>
i=0<br/>
4<br/>
where&#160;f&#160;(x0)&#160;is&#160;the&#160;distribution&#160;of&#160;the&#160;initial&#160;state,&#160;x0:t&#160;=&#160;(x0,&#160;...,&#160;xt)&#160;and<br/>
4<br/>
y0:t&#160;=&#160;(y0,&#160;...,&#160;yt).<br/>
14<br/>
<hr/>
<a name=26></a><img src="./Godsill_1-26_1.jpg"/><br/>
15<br/>
<hr/>
<a name=27></a>Example:&#160;linear&#160;AR&#160;model&#160;observed&#160;in&#160;noise<br/>
P<br/>
X<br/>
zt&#160;=<br/>
aizt−i&#160;+&#160;et<br/>
i=1<br/>
yt&#160;=&#160;zt&#160;+&#160;wt<br/>
with&#160;et&#160;and&#160;wt&#160;independently&#160;distributed&#160;as&#160;zero&#160;mean&#160;Gaussians&#160;with<br/>variance&#160;σ2e&#160;and&#160;σ2w,&#160;respectively&#160;(fixed&#160;and&#160;known).<br/>
ai&#160;are&#160;the&#160;AR&#160;coefficients,&#160;of&#160;order&#160;P&#160;,&#160;also&#160;assumed&#160;here&#160;to&#160;be&#160;fixed&#160;and<br/>known.<br/>
We&#160;observe&#160;the&#160;noisy&#160;signal&#160;yt.<br/>
The&#160;only&#160;unknown&#160;here&#160;is&#160;the&#160;signal&#160;zt.<br/>
16<br/>
<hr/>
<a name=28></a>Form&#160;state&#160;vector&#160;as:<br/>
xt&#160;=&#160;[zt,&#160;zt−1,&#160;...,&#160;zt−P&#160;+1]T<br/>
(4)<br/>
Then&#160;a&#160;state&#160;space&#160;model&#160;in&#160;terms&#160;of&#160;the&#160;signal&#160;values&#160;is&#160;obtained&#160;as:<br/>
xt&#160;=&#160;Axt−1&#160;+&#160;t<br/>
(5)<br/>
yt&#160;=&#160;Bxt&#160;+&#160;wt<br/>
(6)<br/>
17<br/>
<hr/>
<a name=29></a>where:<br/>
<br/>
<br/>
a1&#160;a2&#160;...&#160;aP<br/>
<br/>
<br/>
<br/>
1<br/>
0<br/>
...<br/>
0&#160;<br/>
<br/>
<br/>
A&#160;=&#160;<br/>
<br/>
<br/>
0<br/>
1<br/>
...<br/>
0&#160;<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
0<br/>
0<br/>
...<br/>
0&#160;<br/>
<br/>
<br/>
0<br/>
0<br/>
...<br/>
0<br/>
h<br/>
i<br/>
B&#160;=<br/>
1<br/>
0<br/>
0<br/>
...<br/>
0<br/>
18<br/>
<hr/>
<a name=30></a><br/>
<br/>
σ2e&#160;0&#160;...&#160;0<br/>
<br/>
<br/>
<br/>
0<br/>
0<br/>
...<br/>
0&#160;<br/>
<br/>
<br/>
Σ<br/>
<br/>
<br/>
&#160;=&#160;<br/>
0<br/>
0<br/>
...<br/>
0&#160;<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
0<br/>
0<br/>
...<br/>
0&#160;<br/>
<br/>
<br/>
0<br/>
0<br/>
...<br/>
0<br/>
19<br/>
<hr/>
<a name=31></a>Alternatively,&#160;in&#160;terms&#160;of&#160;state&#160;evolution&#160;and&#160;observation&#160;densities:<br/>
f&#160;(xt+1|xt)&#160;=&#160;N&#160;(xt+1|Axt,&#160;Σ)<br/>
g(yt|xt)&#160;=&#160;N&#160;(yt|Bxt,&#160;σ2w)<br/>
(7)<br/>
20<br/>
<hr/>
<a name=32></a>Alternatively,&#160;in&#160;terms&#160;of&#160;state&#160;evolution&#160;and&#160;observation&#160;densities:<br/>
f&#160;(xt+1|xt)&#160;=&#160;N&#160;(xt+1|Axt,&#160;Σ)<br/>
g(yt|xt)&#160;=&#160;N&#160;(yt|Bxt,&#160;σ2w)<br/>
(7)<br/>
This&#160;is&#160;an&#160;example&#160;of&#160;the&#160;linear&#160;Gaussian&#160;state&#160;space&#160;model,&#160;an&#160;important<br/>
special&#160;case&#160;that&#160;is&#160;used&#160;extensively&#160;to&#160;construct&#160;algorithms&#160;in&#160;the&#160;nonlinear<br/>
non-Gaussian&#160;case&#160;(extended&#160;Kalman&#160;filters,&#160;Rao-Blackwellised&#160;particle<br/>
filters,&#160;...).<br/>
20<br/>
<hr/>
<a name=33></a>Example:&#160;Non-linear&#160;Model:<br/>
xt&#160;=&#160;A(xt−1)&#160;+&#160;vt<br/>
x<br/>
x<br/>
=<br/>
t−1&#160;+&#160;25<br/>
t−1<br/>
+&#160;8&#160;cos(1.2t)&#160;+&#160;vt<br/>
2<br/>
1&#160;+&#160;x2t−1<br/>
yt&#160;=&#160;B(xt)&#160;+&#160;wt<br/>
(x<br/>
=<br/>
t)2&#160;+&#160;wt<br/>
20<br/>
where&#160;vt&#160;∼&#160;N&#160;(0,&#160;σ2)&#160;and&#160;w<br/>
).<br/>
v<br/>
t&#160;∼&#160;N&#160;(0,&#160;σ2<br/>
w<br/>
This&#160;may&#160;be&#160;expressed&#160;in&#160;terms&#160;of&#160;density&#160;functions&#160;as:<br/>
f&#160;(xt+1|xt)&#160;=&#160;N&#160;(xt+1|A(xt),&#160;σ2)<br/>
v<br/>
g(yt|xt)&#160;=&#160;N&#160;(yt|B(xt),&#160;σ2&#160;)<br/>
w<br/>
21<br/>
<hr/>
<a name=34></a>Estimation&#160;tasks<br/>
Given&#160;observed&#160;data&#160;up&#160;to&#160;time&#160;t:<br/>
4<br/>
y0:t&#160;=&#160;(y0,&#160;...,&#160;yt)<br/>
Wish&#160;to&#160;infer&#160;the&#160;‘hidden&#160;states’:<br/>
4<br/>
x0:t&#160;=&#160;(x0,&#160;...,&#160;xt)<br/>
22<br/>
<hr/>
<a name=35></a>Specifically:<br/>
•&#160;Filtering:<br/>
Wish&#160;to&#160;estimate&#160;p(xt|y0:t)&#160;itself&#160;or&#160;expectations&#160;of&#160;the&#160;form<br/>
Z<br/>
h&#160;=&#160;Eh(xt)&#160;=<br/>
h(xt)p(xt|y0:t)dxt<br/>
e.g.&#160;h(xt)&#160;=&#160;xt&#160;-&#160;posterior&#160;mean&#160;estimation&#160;(MMSE&#160;estimator)<br/>
23<br/>
<hr/>
<a name=36></a>Specifically:<br/>
•&#160;Filtering:<br/>
Wish&#160;to&#160;estimate&#160;p(xt|y0:t)&#160;itself&#160;or&#160;expectations&#160;of&#160;the&#160;form<br/>
Z<br/>
h&#160;=&#160;Eh(xt)&#160;=<br/>
h(xt)p(xt|y0:t)dxt<br/>
e.g.&#160;h(xt)&#160;=&#160;xt&#160;-&#160;posterior&#160;mean&#160;estimation&#160;(MMSE&#160;estimator)<br/>
•&#160;Smoothing&#160;(‘fixed&#160;lag’):<br/>
p(xt−L|y0:t)<br/>
23<br/>
<hr/>
<a name=37></a>Specifically:<br/>
•&#160;Filtering:<br/>
Wish&#160;to&#160;estimate&#160;p(xt|y0:t)&#160;itself&#160;or&#160;expectations&#160;of&#160;the&#160;form<br/>
Z<br/>
h&#160;=&#160;Eh(xt)&#160;=<br/>
h(xt)p(xt|y0:t)dxt<br/>
e.g.&#160;h(xt)&#160;=&#160;xt&#160;-&#160;posterior&#160;mean&#160;estimation&#160;(MMSE&#160;estimator)<br/>
•&#160;Smoothing&#160;(‘fixed&#160;lag’):<br/>
p(xt−L|y0:t)<br/>
•&#160;Smoothing&#160;(‘fixed&#160;interval’):<br/>
Estimate&#160;entire&#160;state&#160;sequence&#160;given&#160;all&#160;data:<br/>
p(x0:T&#160;|y0:T&#160;)<br/>
23<br/>
<hr/>
<a name=38></a><img src="./Godsill_1-38_1.jpg"/><br/>
24<br/>
<hr/>
<a name=39></a>Filtering<br/>
At&#160;time&#160;t,&#160;Suppose&#160;we&#160;have&#160;p(xt|y0:t)&#160;but&#160;wish&#160;to&#160;find&#160;p(xt+1|y0:t+1).&#160;In<br/>principle&#160;we&#160;can&#160;use&#160;the&#160;filtering&#160;recursions:<br/>
Prediction&#160;step:<br/>
Z<br/>
p(xt+1|y0:t)&#160;=<br/>
p(xt,&#160;xt+1|y0:t)dxt<br/>
Z<br/>
=<br/>
p(xt|y0:t)p(xt+1|xt,&#160;y0:t)dxt<br/>
Z<br/>
=<br/>
p(xt|y0:t)f&#160;(xt+1|xt)dxt<br/>
(8)<br/>
25<br/>
<hr/>
<a name=40></a>Filtering<br/>
At&#160;time&#160;t,&#160;Suppose&#160;we&#160;have&#160;p(xt|y0:t)&#160;but&#160;wish&#160;to&#160;find&#160;p(xt+1|y0:t+1).&#160;In<br/>principle&#160;we&#160;can&#160;use&#160;the&#160;filtering&#160;recursions:<br/>
Prediction&#160;step:<br/>
Z<br/>
p(xt+1|y0:t)&#160;=<br/>
p(xt,&#160;xt+1|y0:t)dxt<br/>
Z<br/>
=<br/>
p(xt|y0:t)p(xt+1|xt,&#160;y0:t)dxt<br/>
Z<br/>
=<br/>
p(xt|y0:t)f&#160;(xt+1|xt)dxt<br/>
(8)<br/>
Correction&#160;step&#160;(Bayes’&#160;Theorem):<br/>
g(yt+1|xt+1)p(xt+1|y0:t)<br/>
p(xt+1|y0:t+1)&#160;=<br/>
(9)<br/>
p(yt+1|y0:t)<br/>
25<br/>
<hr/>
<a name=41></a>The&#160;sequential&#160;scheme&#160;is&#160;as&#160;follows:<br/>
Time<br/>
t&#160;−&#160;1<br/>
t<br/>
t&#160;+&#160;1<br/>
...<br/>
Data<br/>
yt−1<br/>
yt<br/>
yt+1<br/>
Filtering<br/>
p(xt−1|y0:t−1)<br/>
p(xt|y0:t)<br/>
p(xt+1|y0:t+1)<br/>
Prediction<br/>
p(xt|y0:t−1)<br/>
p(xt+1|y0:t)<br/>
However,&#160;in&#160;the&#160;general&#160;case&#160;the&#160;integral&#160;is&#160;intractable&#160;and&#160;approximations<br/>
must&#160;be&#160;used.&#160;(xt&#160;high-dimensional,&#160;f&#160;(),&#160;g()&#160;non-Gaussian,&#160;...)<br/>
26<br/>
<hr/>
<a name=42></a>Linear&#160;Gaussian&#160;models&#160;-&#160;the&#160;Kalman&#160;filter<br/>
[(Anderson&#160;and&#160;Moore&#160;(79),&#160;Harvey&#160;(89)]<br/>
•&#160;In&#160;cases&#160;where&#160;the&#160;state&#160;space&#160;model&#160;is&#160;linear&#160;and&#160;Gaussian,&#160;the&#160;classic<br/>
Kalman&#160;filter&#160;can&#160;be&#160;applied.&#160;In&#160;this&#160;case&#160;we&#160;have:<br/>
f&#160;(xt+1|xt)&#160;=&#160;N&#160;(xt+1|Axt,&#160;C)<br/>
g(yt|xt)&#160;=&#160;N&#160;(yt|Bxt,&#160;D)<br/>
(10)<br/>
where&#160;N&#160;(x|µ,&#160;Q)&#160;is&#160;the&#160;Gaussian&#160;density&#160;function&#160;with&#160;mean&#160;vector&#160;µ<br/>
and&#160;covariance&#160;matrix&#160;Q.<br/>
27<br/>
<hr/>
<a name=43></a>•&#160;We&#160;can&#160;write&#160;this&#160;equivalently&#160;as:<br/>
xt+1&#160;=&#160;Axt&#160;+&#160;vt<br/>
(11)<br/>
yt&#160;=&#160;Bxt&#160;+&#160;wt<br/>
(12)<br/>
where&#160;vt&#160;and&#160;wt&#160;are&#160;zero&#160;mean&#160;Gaussian&#160;vectors&#160;with&#160;covariance<br/>matrices&#160;C&#160;and&#160;D,&#160;respectively.&#160;vt&#160;and&#160;wt&#160;are&#160;independent&#160;over&#160;time<br/>and&#160;also&#160;independent&#160;of&#160;one&#160;another&#160;(not&#160;strictly&#160;necessary)<br/>
28<br/>
<hr/>
<a name=44></a>•&#160;We&#160;can&#160;write&#160;this&#160;equivalently&#160;as:<br/>
xt+1&#160;=&#160;Axt&#160;+&#160;vt<br/>
(11)<br/>
yt&#160;=&#160;Bxt&#160;+&#160;wt<br/>
(12)<br/>
where&#160;vt&#160;and&#160;wt&#160;are&#160;zero&#160;mean&#160;Gaussian&#160;vectors&#160;with&#160;covariance<br/>matrices&#160;C&#160;and&#160;D,&#160;respectively.&#160;vt&#160;and&#160;wt&#160;are&#160;independent&#160;over&#160;time<br/>and&#160;also&#160;independent&#160;of&#160;one&#160;another&#160;(not&#160;strictly&#160;necessary)<br/>
•&#160;We&#160;also&#160;require&#160;that&#160;the&#160;initial&#160;state&#160;be&#160;Gaussian&#160;distributed:<br/>
p(x0)&#160;=&#160;N&#160;(x0|µ0,&#160;P0)<br/>
28<br/>
<hr/>
<a name=45></a>•&#160;We&#160;first&#160;require&#160;p(xt+1|y0:t),&#160;the&#160;prediction&#160;step&#160;from&#160;the&#160;above&#160;filtering<br/>
recursion:<br/>
Z<br/>
p(xt+1|y0:t)&#160;=<br/>
p(xt|y0:t)f&#160;(xt+1|xt)dxt<br/>
29<br/>
<hr/>
<a name=46></a>•&#160;We&#160;first&#160;require&#160;p(xt+1|y0:t),&#160;the&#160;prediction&#160;step&#160;from&#160;the&#160;above&#160;filtering<br/>
recursion:<br/>
Z<br/>
p(xt+1|y0:t)&#160;=<br/>
p(xt|y0:t)f&#160;(xt+1|xt)dxt<br/>
•&#160;Suppose&#160;that&#160;we&#160;have&#160;already&#160;that&#160;at&#160;time&#160;t:<br/>
p(xt|y0:t)&#160;=&#160;N&#160;(xt|µt,&#160;Pt)<br/>
29<br/>
<hr/>
<a name=47></a>•&#160;Now,&#160;from&#160;<a href="Godsill_1s.html#43">11&#160;</a>we&#160;have<br/>
xt+1&#160;=&#160;Axt&#160;+&#160;vt<br/>
30<br/>
<hr/>
<a name=48></a>•&#160;Now,&#160;from&#160;<a href="Godsill_1s.html#43">11&#160;</a>we&#160;have<br/>
xt+1&#160;=&#160;Axt&#160;+&#160;vt<br/>
Thus&#160;from&#160;standard&#160;transformation&#160;of&#160;variables&#160;theory&#160;(linear&#160;Gaussian<br/>
case)&#160;we&#160;have:<br/>
xt&#160;∼&#160;N&#160;(xt|µt,&#160;Pt)<br/>
xt+1&#160;=&#160;Axt&#160;+&#160;vt<br/>
30<br/>
<hr/>
<a name=49></a>•&#160;Now,&#160;from&#160;<a href="Godsill_1s.html#43">11&#160;</a>we&#160;have<br/>
xt+1&#160;=&#160;Axt&#160;+&#160;vt<br/>
Thus&#160;from&#160;standard&#160;transformation&#160;of&#160;variables&#160;theory&#160;(linear&#160;Gaussian<br/>
case)&#160;we&#160;have:<br/>
xt&#160;∼&#160;N&#160;(xt|µt,&#160;Pt)<br/>
xt+1&#160;=&#160;Axt&#160;+&#160;vt<br/>
Therefore:<br/>
p(xt+1|y0:t)&#160;=&#160;N&#160;(xt+1|µt+1|t,&#160;Pt+1|t)<br/>
where:<br/>
µt+1|t&#160;=&#160;Aµt,&#160;Pt+1|t&#160;=&#160;C&#160;+&#160;APtAT<br/>
(13)<br/>
30<br/>
<hr/>
<a name=50></a>•&#160;Now,&#160;the&#160;correction&#160;step&#160;of&#160;the&#160;above&#160;filtering&#160;recursion&#160;is<br/>
g(yt+1|xt+1)p(xt+1|y0:t)<br/>
p(xt+1|y0:t+1)&#160;=<br/>
(14)<br/>
p(yt+1|y0:t)<br/>
31<br/>
<hr/>
<a name=51></a>•&#160;Now,&#160;the&#160;correction&#160;step&#160;of&#160;the&#160;above&#160;filtering&#160;recursion&#160;is<br/>
g(yt+1|xt+1)p(xt+1|y0:t)<br/>
p(xt+1|y0:t+1)&#160;=<br/>
(14)<br/>
p(yt+1|y0:t)<br/>
•&#160;Substituting&#160;the&#160;above&#160;Gaussian&#160;forms&#160;into&#160;the&#160;numerator&#160;gives:<br/>
p(xt+1|y0:t+1)&#160;∝&#160;N&#160;(yt+1|Bxt+1,&#160;D)N&#160;(xt+1|µt+1|t,&#160;Pt+1|t)<br/>
1<br/>
∝&#160;exp(−&#160;{[yt+1&#160;−&#160;Bxt+1]T&#160;D−1[yt+1&#160;−&#160;Bxt+1]})<br/>
2<br/>
1<br/>
×&#160;exp(−&#160;{[xt+1&#160;−&#160;µ<br/>
[xt+1&#160;−&#160;µ<br/>
2<br/>
t+1|t]T&#160;P&#160;−1<br/>
t+1|t<br/>
t+1|t]})<br/>
1<br/>
∝&#160;exp(−&#160;{[xt+1&#160;−&#160;µt+1]T&#160;P&#160;−1&#160;[xt+1&#160;−&#160;µt+1]})<br/>
2<br/>
t+1<br/>
=&#160;N&#160;(xt+1|µt+1,&#160;Pt+1)<br/>
31<br/>
<hr/>
<a name=52></a>where<br/>
µt+1&#160;=&#160;Pt+1(BT&#160;D−1yt+1&#160;+&#160;P&#160;−1&#160;µ<br/>
t+1|t&#160;t+1|t),&#160;Pt+1&#160;=&#160;(BT&#160;D−1B&#160;+&#160;Pt+1|t)−1<br/>
32<br/>
<hr/>
<a name=53></a>where<br/>
µt+1&#160;=&#160;Pt+1(BT&#160;D−1yt+1&#160;+&#160;P&#160;−1&#160;µ<br/>
t+1|t&#160;t+1|t),&#160;Pt+1&#160;=&#160;(BT&#160;D−1B&#160;+&#160;Pt+1|t)−1<br/>
•&#160;This&#160;expression&#160;can&#160;be&#160;rearranged&#160;using&#160;the&#160;matrix&#160;inversion&#160;lemma&#160;to<br/>
give:<br/>
µt+1&#160;=&#160;µt+1|t&#160;+&#160;Kt(yt+1&#160;−&#160;Bµt+1|t),<br/>
and<br/>
Pt+1&#160;=&#160;(I&#160;−&#160;KtB)Pt+1|t<br/>
where<br/>
Kt&#160;=&#160;Pt+1|tBT&#160;(BPt+1|tBT&#160;+&#160;D)−1<br/>
32<br/>
<hr/>
<a name=54></a>•&#160;Hence&#160;the&#160;whole&#160;Kalman&#160;filtering&#160;recursion&#160;can&#160;be&#160;summarised&#160;as:<br/>
µt+1|t&#160;=&#160;Aµt<br/>
(15)<br/>
Pt+1|t&#160;=&#160;C&#160;+&#160;APtAT<br/>
(16)<br/>
µt+1&#160;=&#160;µt+1|t&#160;+&#160;Kt(yt+1&#160;−&#160;Bµt+1|t)<br/>
(17)<br/>
Pt+1&#160;=&#160;(I&#160;−&#160;KtB)Pt+1|t<br/>
(18)<br/>
Kt&#160;=&#160;Pt+1|tBT&#160;(BPt+1|tBT&#160;+&#160;D)−1<br/>
(19)<br/>
33<br/>
<hr/>
<a name=55></a>Things&#160;you&#160;can&#160;do&#160;with&#160;a&#160;Kalman&#160;filter<br/>
The&#160;Kalman&#160;filter&#160;is&#160;a&#160;fundamental&#160;tool&#160;for&#160;tracking&#160;and&#160;on-line&#160;estimation<br/>
problems:<br/>
•&#160;Estimate&#160;the&#160;system&#160;state&#160;sequentially&#160;using&#160;ˆ<br/>
xt&#160;=&#160;µt<br/>
•&#160;Obtain&#160;an&#160;uncertainty&#160;measure&#160;about&#160;the&#160;state&#160;using&#160;var(ˆ<br/>
xt)&#160;=&#160;Pt<br/>
•&#160;Recursive&#160;least&#160;squares.&#160;With&#160;C&#160;=&#160;0&#160;we&#160;have&#160;the&#160;same&#160;model&#160;and<br/>
updating&#160;rules&#160;as&#160;used&#160;in&#160;the&#160;RLS&#160;algorithm&#160;-&#160;hence&#160;RLS&#160;is&#160;a&#160;special<br/>
case&#160;of&#160;Kalman.<br/>
•&#160;Fixed-lag&#160;smoothing:&#160;augment&#160;the&#160;state&#160;with&#160;past&#160;states:<br/>
x0t&#160;=&#160;[xt&#160;xt−1&#160;.&#160;.&#160;.&#160;xt−p]<br/>
•&#160;Fixed&#160;interval&#160;smoothing:&#160;the&#160;Kalman&#160;smoother&#160;operates&#160;backwards&#160;in<br/>
time,&#160;estimating&#160;recursively&#160;p(xt|y0:T&#160;),&#160;t&#160;&lt;&#160;T&#160;.<br/>
34<br/>
<hr/>
<a name=56></a>Likelihood&#160;evaluation.<br/>
A&#160;key&#160;result&#160;is&#160;that&#160;the&#160;Kalman&#160;filter&#160;can&#160;sequentially&#160;evaluate&#160;the<br/>
likelihood&#160;function,&#160;p(y0:t).&#160;This&#160;is&#160;used&#160;for&#160;maximum&#160;likelihood&#160;or<br/>maximum&#160;a&#160;posteriori&#160;parameter&#160;estimation,&#160;and&#160;also&#160;for&#160;Bayesian&#160;model<br/>
choice&#160;problems&#160;and&#160;the&#160;Rao-Blackwellised&#160;particle&#160;filter.<br/>
35<br/>
<hr/>
<a name=57></a>Likelihood&#160;evaluation.<br/>
A&#160;key&#160;result&#160;is&#160;that&#160;the&#160;Kalman&#160;filter&#160;can&#160;sequentially&#160;evaluate&#160;the<br/>
likelihood&#160;function,&#160;p(y0:t).&#160;This&#160;is&#160;used&#160;for&#160;maximum&#160;likelihood&#160;or<br/>maximum&#160;a&#160;posteriori&#160;parameter&#160;estimation,&#160;and&#160;also&#160;for&#160;Bayesian&#160;model<br/>
choice&#160;problems&#160;and&#160;the&#160;Rao-Blackwellised&#160;particle&#160;filter.<br/>
To&#160;see&#160;how&#160;this&#160;works,&#160;start&#160;from&#160;the&#160;Kalman&#160;prediction&#160;step:<br/>
p(xt+1|y0:t)&#160;=&#160;N&#160;(xt+1|Aµt,&#160;C&#160;+&#160;APtAT&#160;)<br/>
35<br/>
<hr/>
<a name=58></a>Likelihood&#160;evaluation.<br/>
A&#160;key&#160;result&#160;is&#160;that&#160;the&#160;Kalman&#160;filter&#160;can&#160;sequentially&#160;evaluate&#160;the<br/>
likelihood&#160;function,&#160;p(y0:t).&#160;This&#160;is&#160;used&#160;for&#160;maximum&#160;likelihood&#160;or<br/>maximum&#160;a&#160;posteriori&#160;parameter&#160;estimation,&#160;and&#160;also&#160;for&#160;Bayesian&#160;model<br/>
choice&#160;problems&#160;and&#160;the&#160;Rao-Blackwellised&#160;particle&#160;filter.<br/>
To&#160;see&#160;how&#160;this&#160;works,&#160;start&#160;from&#160;the&#160;Kalman&#160;prediction&#160;step:<br/>
p(xt+1|y0:t)&#160;=&#160;N&#160;(xt+1|Aµt,&#160;C&#160;+&#160;APtAT&#160;)<br/>
Now,&#160;equation&#160;<a href="Godsill_1s.html#43">12&#160;</a>expresses&#160;yt+1&#160;in&#160;terms&#160;of&#160;Bxt+1&#160;plus&#160;a&#160;random&#160;Gaussian<br/>disturbance&#160;wt+1&#160;with&#160;covariance&#160;matrix&#160;D:<br/>
yt+1&#160;=&#160;Bxt+1&#160;+&#160;wt+1<br/>
35<br/>
<hr/>
<a name=59></a>Hence,&#160;again&#160;using&#160;transformation&#160;of&#160;Gaussian&#160;variables,&#160;we&#160;can&#160;obtain&#160;the<br/>
conditional&#160;likelihood:<br/>
p(yt+1|y0:t)&#160;=&#160;N&#160;(yt+1|Bµt+1|t,&#160;D&#160;+&#160;BPt+1|tBT&#160;)<br/>
Finally,&#160;using&#160;the&#160;probability&#160;chain&#160;rule,&#160;we&#160;obtain&#160;the&#160;likelihood&#160;function:<br/>
T&#160;−1<br/>
Y<br/>
p(y0:T&#160;)&#160;=&#160;p(y0)<br/>
p(yt+1|y0:t)<br/>
t=0<br/>
36<br/>
<hr/>
<a name=60></a>Numerical&#160;methods&#160;-&#160;or&#160;things&#160;you&#160;can’t&#160;do&#160;with&#160;the&#160;Kalman&#160;filter<br/>
•&#160;The&#160;Kalman&#160;filter&#160;is&#160;optimal&#160;only&#160;for&#160;the&#160;linear&#160;Gaussian&#160;model.&#160;In<br/>
other&#160;cases&#160;the&#160;Kalman&#160;filter&#160;will&#160;give&#160;the&#160;best&#160;linear&#160;estimator&#160;in&#160;a<br/>
mean-square&#160;error&#160;sense,&#160;but&#160;this&#160;may&#160;not&#160;be&#160;good&#160;enough&#160;for&#160;highly<br/>
non-linear&#160;or&#160;non-Gaussian&#160;models<br/>
•&#160;There&#160;are&#160;numerous&#160;methods&#160;for&#160;dealing&#160;with&#160;more&#160;general&#160;models,&#160;all<br/>
based&#160;on&#160;numerical&#160;approximations&#160;to&#160;the&#160;filtering&#160;recursions&#160;of<br/>
equations&#160;<a href="Godsill_1s.html#39">8&#160;</a>and&#160;<a href="Godsill_1s.html#40">9,&#160;</a>e.g.&#160;the&#160;Gaussian&#160;sum&#160;filter,&#160;unscented&#160;Kalman<br/>
filter,&#160;etc...<br/>
•&#160;Here&#160;we&#160;will&#160;consider&#160;two&#160;important&#160;examples:&#160;the&#160;extended&#160;Kalman<br/>
filter&#160;(EKF)&#160;and&#160;the&#160;Monte&#160;Carlo&#160;particle&#160;filter<br/>
37<br/>
<hr/>
<a name=61></a>The&#160;extended&#160;Kalman&#160;filter&#160;(EKF)<br/>
The&#160;extended&#160;Kalman&#160;filter&#160;is&#160;the&#160;classical&#160;method&#160;for&#160;estimating&#160;non-linear<br/>
state-space&#160;systems.<br/>
•&#160;Consider&#160;the&#160;following&#160;non-linear&#160;state-space&#160;model,&#160;which&#160;is&#160;the<br/>
non-linear&#160;equivalent&#160;to&#160;equations&#160;<a href="Godsill_1s.html#43">11&#160;</a>and&#160;<a href="Godsill_1s.html#43">12:</a><br/>
xt+1&#160;=&#160;A(xt)&#160;+&#160;vt<br/>
(20)<br/>
yt&#160;=&#160;B(xt)&#160;+&#160;wt<br/>
(21)<br/>
where&#160;A()&#160;and&#160;B()&#160;are&#160;now&#160;non-linear&#160;functions.<br/>
38<br/>
<hr/>
<a name=62></a>•&#160;Perform&#160;a&#160;1st&#160;order&#160;Taylor&#160;expansion&#160;of&#160;A()&#160;and&#160;B()&#160;around&#160;the&#160;points<br/>
µt&#160;and&#160;µt|t−1,&#160;respectively:<br/>
∂A(x&#160;<br/>
t)<br/>
A(x<br/>
<br/>
t)&#160;≈&#160;A(µt)&#160;+<br/>
<br/>
(xt&#160;−&#160;µt)<br/>
∂xt&#160;xt=µt<br/>
∂B(x&#160;<br/>
t)<br/>
B(x<br/>
<br/>
t)&#160;≈&#160;B(µt|t−1)&#160;+<br/>
<br/>
(xt&#160;−&#160;µ<br/>
∂x<br/>
t|t−1)<br/>
t<br/>
xt=µt|t−1<br/>
•&#160;Substituting&#160;these&#160;approximations&#160;into&#160;the&#160;state-space&#160;model&#160;leads&#160;to&#160;a<br/>
linearized&#160;set&#160;of&#160;equations&#160;which&#160;can&#160;be&#160;solved&#160;using&#160;the&#160;standard<br/>
Kalman&#160;filter<br/>
•&#160;Limitatations&#160;-&#160;the&#160;approximation&#160;is&#160;still&#160;unimodal,&#160;hence&#160;for<br/>
multimodal&#160;distributions&#160;the&#160;filter&#160;will&#160;fail<br/>
•&#160;Also&#160;the&#160;tracking&#160;performance&#160;and&#160;error&#160;covariance&#160;estimates&#160;will&#160;be<br/>
sub-optimal<br/>
39<br/>
<hr/>
<a name=63></a>Monte&#160;Carlo&#160;Filtering<br/>
Consider&#160;numerical&#160;estimation&#160;of&#160;the&#160;following&#160;expectation:<br/>
Z<br/>
h&#160;=&#160;Eh(xt)&#160;=<br/>
h(xt)p(xt|y0:t)dxt<br/>
•&#160;If&#160;the&#160;integral&#160;is&#160;intractable&#160;then&#160;we&#160;can&#160;resort&#160;to&#160;a&#160;Monte&#160;Carlo<br/>
integration:<br/>
N<br/>
X<br/>
(i)<br/>
(i)&#160;iid<br/>
b<br/>
h&#160;=&#160;1/N<br/>
h(x<br/>
),<br/>
where&#160;x<br/>
∼&#160;p(x<br/>
t<br/>
t<br/>
t|y0:t)<br/>
(22)<br/>
i=1<br/>
40<br/>
<hr/>
<a name=64></a>Monte&#160;Carlo&#160;Filtering<br/>
Consider&#160;numerical&#160;estimation&#160;of&#160;the&#160;following&#160;expectation:<br/>
Z<br/>
h&#160;=&#160;Eh(xt)&#160;=<br/>
h(xt)p(xt|y0:t)dxt<br/>
•&#160;If&#160;the&#160;integral&#160;is&#160;intractable&#160;then&#160;we&#160;can&#160;resort&#160;to&#160;a&#160;Monte&#160;Carlo<br/>
integration:<br/>
N<br/>
X<br/>
(i)<br/>
(i)&#160;iid<br/>
b<br/>
h&#160;=&#160;1/N<br/>
h(x<br/>
),<br/>
where&#160;x<br/>
∼&#160;p(x<br/>
t<br/>
t<br/>
t|y0:t)<br/>
(22)<br/>
i=1<br/>
•&#160;More&#160;generally,&#160;when&#160;we&#160;cannot&#160;sample&#160;directly&#160;from&#160;p(xt|y0:t),&#160;we&#160;can<br/>
sample&#160;from&#160;another&#160;distribution&#160;q(xt)&#160;(‘importance&#160;function’)&#160;having<br/>the&#160;same&#160;support&#160;as&#160;p(xt|y0:t).&#160;So&#160;we&#160;make&#160;N&#160;random&#160;draws&#160;from&#160;q()<br/>instead&#160;of&#160;p():<br/>
(i)<br/>
x<br/>
∼&#160;q(x<br/>
t<br/>
t),<br/>
i&#160;=&#160;1,&#160;...,&#160;N<br/>
40<br/>
<hr/>
<a name=65></a>•&#160;Now&#160;we&#160;have&#160;to&#160;make&#160;a&#160;correction&#160;to&#160;ensure&#160;that&#160;the&#160;expectation<br/>
estimate&#160;is&#160;good.&#160;It&#160;turns&#160;out&#160;that&#160;the&#160;required&#160;correction&#160;is<br/>
proportional&#160;to&#160;the&#160;ratio&#160;p()/q(),&#160;which&#160;is&#160;termed&#160;the&#160;importance<br/>
weight:<br/>
(i)<br/>
(i)<br/>
p(x<br/>
|y0:t)<br/>
w<br/>
∝<br/>
t<br/>
t<br/>
q(xi)<br/>
t<br/>
41<br/>
<hr/>
<a name=66></a>•&#160;Now&#160;we&#160;have&#160;to&#160;make&#160;a&#160;correction&#160;to&#160;ensure&#160;that&#160;the&#160;expectation<br/>
estimate&#160;is&#160;good.&#160;It&#160;turns&#160;out&#160;that&#160;the&#160;required&#160;correction&#160;is<br/>
proportional&#160;to&#160;the&#160;ratio&#160;p()/q(),&#160;which&#160;is&#160;termed&#160;the&#160;importance<br/>
weight:<br/>
(i)<br/>
(i)<br/>
p(x<br/>
|y0:t)<br/>
w<br/>
∝<br/>
t<br/>
t<br/>
q(xi)<br/>
t<br/>
•<br/>
(i)<br/>
If&#160;we&#160;normalise&#160;the&#160;importance&#160;weights&#160;such&#160;that&#160;PN&#160;w<br/>
=&#160;1&#160;we&#160;can<br/>
i=1<br/>
t<br/>
form&#160;an&#160;empirical&#160;approximation&#160;to&#160;the&#160;filtering&#160;density:<br/>
N<br/>
X<br/>
(i)<br/>
p(xt|y0:t)&#160;≈<br/>
w<br/>
δ<br/>
(x<br/>
t<br/>
(i)<br/>
x<br/>
t)<br/>
(23)<br/>
t<br/>
i=1<br/>
41<br/>
<hr/>
<a name=67></a>from&#160;which&#160;expectation&#160;estimates&#160;can&#160;be&#160;obtained&#160;as:<br/>
N<br/>
X<br/>
(i)<br/>
b<br/>
h&#160;=<br/>
w(i)h(x<br/>
),<br/>
(24)<br/>
t<br/>
i=1<br/>
N<br/>
(i)&#160;iid<br/>
(i)<br/>
(i)<br/>
(i)<br/>
X<br/>
(i)<br/>
where&#160;x<br/>
∼&#160;q(x<br/>
|y<br/>
),<br/>
w<br/>
=&#160;1<br/>
(25)<br/>
t<br/>
t),<br/>
wt&#160;∝&#160;p(xt<br/>
0:t)/q(xt<br/>
t<br/>
i=1<br/>
42<br/>
<hr/>
<a name=68></a>from&#160;which&#160;expectation&#160;estimates&#160;can&#160;be&#160;obtained&#160;as:<br/>
N<br/>
X<br/>
(i)<br/>
b<br/>
h&#160;=<br/>
w(i)h(x<br/>
),<br/>
(24)<br/>
t<br/>
i=1<br/>
N<br/>
(i)&#160;iid<br/>
(i)<br/>
(i)<br/>
(i)<br/>
X<br/>
(i)<br/>
where&#160;x<br/>
∼&#160;q(x<br/>
|y<br/>
),<br/>
w<br/>
=&#160;1<br/>
(25)<br/>
t<br/>
t),<br/>
wt&#160;∝&#160;p(xt<br/>
0:t)/q(xt<br/>
t<br/>
i=1<br/>
i.e.<br/>
Z<br/>
h&#160;=&#160;Eh(xt)&#160;=<br/>
h(xt)p(xt|y0:t)dxt<br/>
N<br/>
N<br/>
Z<br/>
X<br/>
X<br/>
≈<br/>
(i)<br/>
(i)<br/>
h(xt)<br/>
w<br/>
δ<br/>
(x<br/>
w(i)h(x<br/>
)<br/>
t<br/>
(i)<br/>
x<br/>
t)dxt&#160;=<br/>
t<br/>
t<br/>
i=1<br/>
i=1<br/>
42<br/>
<hr/>
<a name=69></a>•&#160;Resampling&#160;(this&#160;will&#160;prove&#160;important&#160;in&#160;the&#160;sequential&#160;setting).&#160;We<br/>
now&#160;have&#160;the&#160;option&#160;of&#160;resampling&#160;the&#160;the&#160;particles&#160;so&#160;they&#160;have<br/>
uniform&#160;weights:<br/>
(i)<br/>
(i)<br/>
Set&#160;x0(i)&#160;=&#160;x<br/>
with&#160;probability&#160;w<br/>
t<br/>
t<br/>
t<br/>
and&#160;set&#160;w0(i)&#160;=&#160;1/N&#160;.<br/>
t+1<br/>
43<br/>
<hr/>
<a name=70></a>•&#160;Resampling&#160;(this&#160;will&#160;prove&#160;important&#160;in&#160;the&#160;sequential&#160;setting).&#160;We<br/>
now&#160;have&#160;the&#160;option&#160;of&#160;resampling&#160;the&#160;the&#160;particles&#160;so&#160;they&#160;have<br/>
uniform&#160;weights:<br/>
(i)<br/>
(i)<br/>
Set&#160;x0(i)&#160;=&#160;x<br/>
with&#160;probability&#160;w<br/>
t<br/>
t<br/>
t<br/>
and&#160;set&#160;w0(i)&#160;=&#160;1/N&#160;.<br/>
t+1<br/>
While&#160;this&#160;is&#160;unnecessary&#160;in&#160;the&#160;static&#160;case,&#160;and&#160;would&#160;always&#160;increase<br/>
the&#160;Monte&#160;Carlo&#160;variation&#160;of&#160;our&#160;estimators,&#160;it&#160;is&#160;a&#160;vital&#160;component&#160;of<br/>
the&#160;sequential&#160;schemes&#160;which&#160;follow,&#160;limiting&#160;degeneracy&#160;of&#160;the<br/>
importance&#160;weights&#160;over&#160;time.&#160;Note&#160;that&#160;resampling&#160;schemes&#160;can<br/>
incorporate&#160;variance&#160;reduction&#160;strategies&#160;such&#160;as&#160;stratification&#160;in&#160;order<br/>
to&#160;improve&#160;performance.<br/>
43<br/>
<hr/>
<a name=71></a>•&#160;We&#160;now&#160;have&#160;a&#160;means&#160;for&#160;approximating&#160;p(xt|y0:t)&#160;and&#160;also<br/>
expectations&#160;of&#160;xt.<br/>
•&#160;But,&#160;how&#160;do&#160;we&#160;adapt&#160;this&#160;to&#160;the&#160;sequential&#160;context?&#160;(Note&#160;that<br/>
p(xt|y0:t)&#160;cannot&#160;in&#160;general&#160;be&#160;evaluated).<br/>
44<br/>
<hr/>
<a name=72></a>Sequential&#160;Monte&#160;Carlo&#160;(SMC)&#160;-&#160;the&#160;Particle&#160;filter<br/>
A&#160;generic&#160;solution&#160;involves&#160;repeated&#160;importance&#160;sampling/resampling<br/>
sequentially&#160;through&#160;time&#160;(particle&#160;filter)&#160;(see&#160;e.g.&#160;Gordon&#160;et&#160;al.&#160;1993<br/>
(IEE),&#160;Kitagawa&#160;(1993,&#160;J.&#160;Comp.Graph.&#160;Stats.),&#160;Doucet&#160;Godsill&#160;Andrieu<br/>
2000&#160;(Stats.&#160;amd&#160;computing),&#160;Liu&#160;and&#160;Chen&#160;1997&#160;(JASA)).<br/>
The&#160;SMC&#160;scheme&#160;mimics&#160;the&#160;filtering&#160;recursions&#160;as&#160;follows:<br/>
45<br/>
<hr/>
<a name=73></a>Sequential&#160;Monte&#160;Carlo&#160;(SMC)&#160;-&#160;the&#160;Particle&#160;filter<br/>
A&#160;generic&#160;solution&#160;involves&#160;repeated&#160;importance&#160;sampling/resampling<br/>
sequentially&#160;through&#160;time&#160;(particle&#160;filter)&#160;(see&#160;e.g.&#160;Gordon&#160;et&#160;al.&#160;1993<br/>
(IEE),&#160;Kitagawa&#160;(1993,&#160;J.&#160;Comp.Graph.&#160;Stats.),&#160;Doucet&#160;Godsill&#160;Andrieu<br/>
2000&#160;(Stats.&#160;amd&#160;computing),&#160;Liu&#160;and&#160;Chen&#160;1997&#160;(JASA)).<br/>
The&#160;SMC&#160;scheme&#160;mimics&#160;the&#160;filtering&#160;recursions&#160;as&#160;follows:<br/>
•&#160;Suppose&#160;we&#160;have&#160;available&#160;a&#160;collection&#160;of&#160;samples,&#160;or&#160;‘particles’&#160;drawn<br/>
randomly&#160;from&#160;the&#160;filtering&#160;density&#160;at&#160;time&#160;t:<br/>
(i)<br/>
x<br/>
∼&#160;p(x<br/>
t<br/>
t|y0:t),<br/>
i&#160;=&#160;1,&#160;...,&#160;N<br/>
(N&#160;large)<br/>
i.e.<br/>
N<br/>
1&#160;X<br/>
(i)<br/>
p(xt|y0:t)&#160;'<br/>
δ(xt&#160;−&#160;x&#160;)<br/>
N<br/>
t<br/>
i=1<br/>
45<br/>
<hr/>
<a name=74></a>•&#160;Substitute&#160;this&#160;into&#160;the&#160;prediction&#160;equation:<br/>
Z<br/>
p(xt+1|y0:t)&#160;=<br/>
p(xt|y0:t)f&#160;(xt+1|xt)dxt<br/>
N<br/>
Z<br/>
1&#160;X<br/>
≈<br/>
(i)<br/>
δ(xt&#160;−&#160;x&#160;)f&#160;(xt+1|xt)dxt<br/>
N<br/>
t<br/>
i=1<br/>
N<br/>
1&#160;X<br/>
(i)<br/>
=<br/>
f&#160;(xt+1|x&#160;)<br/>
N<br/>
t<br/>
i=1<br/>
46<br/>
<hr/>
<a name=75></a>•&#160;Substitute&#160;this&#160;into&#160;the&#160;prediction&#160;equation:<br/>
Z<br/>
p(xt+1|y0:t)&#160;=<br/>
p(xt|y0:t)f&#160;(xt+1|xt)dxt<br/>
N<br/>
Z<br/>
1&#160;X<br/>
≈<br/>
(i)<br/>
δ(xt&#160;−&#160;x&#160;)f&#160;(xt+1|xt)dxt<br/>
N<br/>
t<br/>
i=1<br/>
N<br/>
1&#160;X<br/>
(i)<br/>
=<br/>
f&#160;(xt+1|x&#160;)<br/>
N<br/>
t<br/>
i=1<br/>
•&#160;Then&#160;perform&#160;the&#160;correction&#160;step&#160;using&#160;Bayes’&#160;theorem:<br/>
(i)<br/>
1&#160;g(yt+1|xt+1)&#160;PN&#160;f&#160;(xt+1|x&#160;))<br/>
p(x<br/>
i=1<br/>
t<br/>
t+1|y0:t+1)&#160;≈&#160;N<br/>
p(yt+1|y0:t)<br/>
46<br/>
<hr/>
<a name=76></a>•&#160;SMC&#160;is&#160;a&#160;collection&#160;of&#160;methods&#160;for&#160;drawing&#160;random&#160;samples&#160;from&#160;the<br/>
above&#160;Monte&#160;Carlo&#160;approximation&#160;to&#160;p(xt+1|y0:t+1),&#160;i.e.&#160;producing&#160;a<br/>new&#160;set&#160;of&#160;random&#160;draws:<br/>
(i)<br/>
x<br/>
∼&#160;p(x<br/>
t+1<br/>
t+1|y0:t+1),<br/>
i&#160;=&#160;1,&#160;...,&#160;N<br/>
(N&#160;large)<br/>
47<br/>
<hr/>
<a name=77></a>•&#160;SMC&#160;is&#160;a&#160;collection&#160;of&#160;methods&#160;for&#160;drawing&#160;random&#160;samples&#160;from&#160;the<br/>
above&#160;Monte&#160;Carlo&#160;approximation&#160;to&#160;p(xt+1|y0:t+1),&#160;i.e.&#160;producing&#160;a<br/>new&#160;set&#160;of&#160;random&#160;draws:<br/>
(i)<br/>
x<br/>
∼&#160;p(x<br/>
t+1<br/>
t+1|y0:t+1),<br/>
i&#160;=&#160;1,&#160;...,&#160;N<br/>
(N&#160;large)<br/>
•&#160;These&#160;random&#160;samples&#160;can&#160;be&#160;obtained&#160;by&#160;many&#160;means:<br/>
–&#160;Rejection&#160;sampling&#160;(slow&#160;but&#160;exact&#160;-&#160;requires&#160;an&#160;envelope&#160;function)<br/>
–&#160;Importance&#160;sampling&#160;-&#160;most&#160;common&#160;procedure<br/>
–&#160;MCMC&#160;-&#160;effective&#160;but&#160;slow&#160;[note&#160;that&#160;MCMC&#160;can&#160;be&#160;applied&#160;in<br/>
conjunction&#160;with&#160;IS&#160;-&#160;then&#160;very&#160;effective]<br/>
–&#160;Special&#160;schemes&#160;such&#160;as&#160;annealed&#160;importance&#160;sampling.<br/>
47<br/>
<hr/>
<a name=78></a>There&#160;are&#160;many&#160;variants&#160;on&#160;schemes&#160;to&#160;achieve&#160;this&#160;(Bootstrap&#160;filter<br/>
(Gordon&#160;et&#160;al.&#160;1993,&#160;Sequential&#160;Importance&#160;sampling,&#160;(Doucet&#160;Godsill<br/>
Andrieu&#160;(2000),&#160;Liu&#160;and&#160;Chen&#160;(1997)),&#160;Auxiliary&#160;Particle&#160;filters&#160;(Pitt<br/>
and&#160;Shephard&#160;(1998)),&#160;etc.<br/>
48<br/>
<hr/>
<a name=79></a>•&#160;Consider&#160;updating&#160;the&#160;filtering&#160;distribution&#160;from&#160;t&#160;to&#160;t&#160;+&#160;1:<br/>
Step&#160;0:<br/>
p(xt,&#160;xt+1|y0:t)&#160;=&#160;p(xt|y0:t)f&#160;(xt+1|xt)<br/>
Step&#160;1:<br/>
Z<br/>
p(xt+1|y0:t)&#160;=<br/>
p(xt,&#160;xt+1|y0:t)dxt<br/>
Step&#160;2:<br/>
g(yt+1|xt+1)p(xt+1|y0:t)<br/>
p(xt+1|y0:t+1)&#160;=<br/>
p(yt+1|y0:t)<br/>
49<br/>
<hr/>
<a name=80></a>•&#160;We&#160;would&#160;like&#160;to&#160;mimic&#160;the&#160;three&#160;steps&#160;here&#160;by&#160;Monte&#160;Carlo&#160;operations.<br/>
50<br/>
<hr/>
<a name=81></a>•&#160;We&#160;would&#160;like&#160;to&#160;mimic&#160;the&#160;three&#160;steps&#160;here&#160;by&#160;Monte&#160;Carlo&#160;operations.<br/>
•&#160;Suppose&#160;we&#160;start&#160;off&#160;with&#160;many&#160;‘particles’&#160;drawn&#160;from&#160;the&#160;filtering<br/>
distribution&#160;p(xt|y0:t).&#160;We&#160;label&#160;these&#160;particles&#160;as<br/>
(i)<br/>
x<br/>
,<br/>
i&#160;=&#160;1,&#160;2,&#160;...,&#160;N&#160;with&#160;N&#160;&gt;&gt;&#160;1<br/>
t<br/>
50<br/>
<hr/>
<a name=82></a>•&#160;We&#160;would&#160;like&#160;to&#160;mimic&#160;the&#160;three&#160;steps&#160;here&#160;by&#160;Monte&#160;Carlo&#160;operations.<br/>
•&#160;Suppose&#160;we&#160;start&#160;off&#160;with&#160;many&#160;‘particles’&#160;drawn&#160;from&#160;the&#160;filtering<br/>
distribution&#160;p(xt|y0:t).&#160;We&#160;label&#160;these&#160;particles&#160;as<br/>
(i)<br/>
x<br/>
,<br/>
i&#160;=&#160;1,&#160;2,&#160;...,&#160;N&#160;with&#160;N&#160;&gt;&gt;&#160;1<br/>
t<br/>
•&#160;These&#160;can&#160;be&#160;used&#160;to&#160;plot&#160;histogram&#160;estimates&#160;of&#160;p(xt|y0:t),&#160;form&#160;Monte<br/>
Carlo&#160;estimates&#160;of&#160;expectations,&#160;...,&#160;in&#160;fact&#160;perform&#160;almost&#160;any&#160;inference<br/>
procedure&#160;we&#160;care&#160;to&#160;choose,&#160;provided&#160;N&#160;is&#160;‘sufficiently’&#160;large.<br/>
50<br/>
<hr/>
<a name=83></a>•<br/>
(i)<br/>
We&#160;can&#160;simulate&#160;Step&#160;0&#160;above&#160;by&#160;taking&#160;each&#160;particle&#160;x<br/>
in&#160;turn&#160;and<br/>
t<br/>
generating&#160;a&#160;new&#160;state&#160;from&#160;the&#160;state&#160;transition&#160;density&#160;according&#160;to:<br/>
(i)<br/>
(i)<br/>
x<br/>
∼&#160;f&#160;(x<br/>
)<br/>
t+1<br/>
t+1|xt<br/>
51<br/>
<hr/>
<a name=84></a>•<br/>
(i)<br/>
We&#160;can&#160;simulate&#160;Step&#160;0&#160;above&#160;by&#160;taking&#160;each&#160;particle&#160;x<br/>
in&#160;turn&#160;and<br/>
t<br/>
generating&#160;a&#160;new&#160;state&#160;from&#160;the&#160;state&#160;transition&#160;density&#160;according&#160;to:<br/>
(i)<br/>
(i)<br/>
x<br/>
∼&#160;f&#160;(x<br/>
)<br/>
t+1<br/>
t+1|xt<br/>
•<br/>
(i)<br/>
(i)<br/>
Each&#160;pair&#160;(x<br/>
,&#160;x<br/>
)&#160;is&#160;now&#160;a&#160;joint&#160;random&#160;sample&#160;from&#160;p(x<br/>
t<br/>
t+1<br/>
t,&#160;xt+1|y0:t).<br/>
51<br/>
<hr/>
<a name=85></a>•<br/>
(i)<br/>
We&#160;can&#160;simulate&#160;Step&#160;0&#160;above&#160;by&#160;taking&#160;each&#160;particle&#160;x<br/>
in&#160;turn&#160;and<br/>
t<br/>
generating&#160;a&#160;new&#160;state&#160;from&#160;the&#160;state&#160;transition&#160;density&#160;according&#160;to:<br/>
(i)<br/>
(i)<br/>
x<br/>
∼&#160;f&#160;(x<br/>
)<br/>
t+1<br/>
t+1|xt<br/>
•<br/>
(i)<br/>
(i)<br/>
Each&#160;pair&#160;(x<br/>
,&#160;x<br/>
)&#160;is&#160;now&#160;a&#160;joint&#160;random&#160;sample&#160;from&#160;p(x<br/>
t<br/>
t+1<br/>
t,&#160;xt+1|y0:t).<br/>
•<br/>
(i)<br/>
By&#160;construction,&#160;x<br/>
taken&#160;on&#160;its&#160;own&#160;is&#160;a&#160;random&#160;sample&#160;from&#160;the<br/>
t+1<br/>
required&#160;marginal&#160;distribution&#160;p(xt+1|y0:t),&#160;(Step&#160;1)<br/>
51<br/>
<hr/>
<a name=86></a>•<br/>
(i)<br/>
We&#160;can&#160;simulate&#160;Step&#160;0&#160;above&#160;by&#160;taking&#160;each&#160;particle&#160;x<br/>
in&#160;turn&#160;and<br/>
t<br/>
generating&#160;a&#160;new&#160;state&#160;from&#160;the&#160;state&#160;transition&#160;density&#160;according&#160;to:<br/>
(i)<br/>
(i)<br/>
x<br/>
∼&#160;f&#160;(x<br/>
)<br/>
t+1<br/>
t+1|xt<br/>
•<br/>
(i)<br/>
(i)<br/>
Each&#160;pair&#160;(x<br/>
,&#160;x<br/>
)&#160;is&#160;now&#160;a&#160;joint&#160;random&#160;sample&#160;from&#160;p(x<br/>
t<br/>
t+1<br/>
t,&#160;xt+1|y0:t).<br/>
•<br/>
(i)<br/>
By&#160;construction,&#160;x<br/>
taken&#160;on&#160;its&#160;own&#160;is&#160;a&#160;random&#160;sample&#160;from&#160;the<br/>
t+1<br/>
required&#160;marginal&#160;distribution&#160;p(xt+1|y0:t),&#160;(Step&#160;1)<br/>
51<br/>
<hr/>
<a name=87></a>•&#160;Step&#160;2.&#160;We&#160;now&#160;have&#160;samples&#160;from&#160;p(xt+1|y0:t).&#160;Step&#160;2&#160;gives&#160;us&#160;the<br/>
appropriate&#160;importance&#160;weight:<br/>
p(xt+1|y0:t+1)<br/>
wt+1&#160;∝<br/>
q(xt+1)<br/>
g(yt+1|xt+1)p(xt+1|y0:t)<br/>
p(y<br/>
∝<br/>
t+1|y0:t)<br/>
p(xt+1|y0:t)<br/>
∝&#160;g(yt+1|xt+1)<br/>
52<br/>
<hr/>
<a name=88></a>•&#160;We&#160;now&#160;have&#160;the&#160;option&#160;of<br/>
1.&#160;retaining&#160;weighted&#160;particles,&#160;in&#160;which&#160;case&#160;the&#160;weights&#160;are<br/>
accumulated&#160;over&#160;time&#160;as<br/>
wt+1&#160;∝&#160;wt&#160;g(yt+1|xt+1)<br/>
53<br/>
<hr/>
<a name=89></a>•&#160;We&#160;now&#160;have&#160;the&#160;option&#160;of<br/>
1.&#160;retaining&#160;weighted&#160;particles,&#160;in&#160;which&#160;case&#160;the&#160;weights&#160;are<br/>
accumulated&#160;over&#160;time&#160;as<br/>
wt+1&#160;∝&#160;wt&#160;g(yt+1|xt+1)<br/>
Or:<br/>
2.&#160;Resampling&#160;the&#160;particles&#160;so&#160;they&#160;have&#160;uniform&#160;weights:<br/>
(i)<br/>
(i)<br/>
Set&#160;x0(i)&#160;=&#160;x<br/>
with&#160;probability&#160;w<br/>
t+1<br/>
t+1<br/>
t<br/>
and&#160;set&#160;w0(i)&#160;=&#160;1/N&#160;.<br/>
t+1<br/>
53<br/>
<hr/>
<a name=90></a>•&#160;A&#160;basic&#160;algorithm&#160;with&#160;(optional)&#160;resampling&#160;at&#160;every&#160;time&#160;step,&#160;the<br/>
‘Bootstrap&#160;Filter’,&#160;is&#160;thus&#160;(Gordon,&#160;Salmond&#160;and&#160;Smith&#160;1993,&#160;Kitagawa<br/>
1996:<br/>
For&#160;t&#160;=&#160;1,&#160;2...,&#160;T<br/>
For&#160;i&#160;=&#160;1,&#160;2,&#160;...,&#160;N<br/>
(i)<br/>
(i)<br/>
(i)<br/>
x<br/>
∼&#160;f&#160;(x<br/>
|x&#160;)<br/>
t+1<br/>
t+1<br/>
t<br/>
(i)<br/>
(i)<br/>
(i)<br/>
w<br/>
g(y<br/>
)<br/>
t+1&#160;∝&#160;wt<br/>
t+1|xt+1<br/>
End<br/>
For&#160;i&#160;=&#160;1,&#160;2,&#160;...,&#160;N<br/>
(i)<br/>
(i)<br/>
(i)<br/>
(Optional)&#160;Resample&#160;x<br/>
with&#160;probability&#160;w<br/>
.&#160;Set&#160;w<br/>
=&#160;1/N<br/>
t+1<br/>
t+1<br/>
t+1<br/>
End<br/>
End<br/>
54<br/>
<hr/>
<a name=91></a>Example:&#160;standard&#160;nonlinear&#160;model<br/>
xt&#160;=&#160;A(xt−1)&#160;+&#160;vt<br/>
xt−1<br/>
xt−1<br/>
=<br/>
+&#160;25<br/>
+&#160;8&#160;cos(1.2t)&#160;+&#160;vt<br/>
2<br/>
1&#160;+&#160;x2t−1<br/>
yt&#160;=&#160;B(xt)&#160;+&#160;wt<br/>
(xt)2<br/>
=<br/>
+&#160;wt<br/>
20<br/>
where&#160;vt&#160;∼&#160;N&#160;(0,&#160;σ2v)&#160;and&#160;wt&#160;∼&#160;N&#160;(0,&#160;σ2w).<br/>
This&#160;may&#160;be&#160;expressed&#160;in&#160;terms&#160;of&#160;density&#160;functions&#160;as:<br/>
f&#160;(xt+1|xt)&#160;=&#160;N&#160;(xt+1|A(xt),&#160;σ2v)<br/>
g(yt|xt)&#160;=&#160;N&#160;(yt|B(xt),&#160;σ2w)<br/>
55<br/>
<hr/>
<a name=92></a><img src="./Godsill_1-92_1.jpg"/><br/>
Figure&#160;1:&#160;Bootstrap&#160;filter&#160;operation&#160;-&#160;nonlinear&#160;model<br/>
56<br/>
<hr/>
<a name=93></a>General&#160;Sequential&#160;Importance&#160;Sampling<br/>
We&#160;can&#160;do&#160;better&#160;in&#160;many&#160;cases&#160;than&#160;the&#160;basic&#160;bootstrap&#160;filter,&#160;by&#160;choosing<br/>
a&#160;better&#160;importance&#160;function.&#160;Consider&#160;now&#160;the&#160;following&#160;modified&#160;updates:<br/>
Step&#160;0’:<br/>
q(xt,&#160;xt+1|y0:t+1)&#160;=&#160;p(xt|y0:t)q(xt+1|xt,&#160;y0:t+1)<br/>
Step&#160;2’:<br/>
g(yt+1|xt+1)f&#160;(xt+1|xt)p(xt|y0:t)<br/>
p(xt,&#160;xt+1|y0:t+1)&#160;=<br/>
p(yt+1|y0:t)<br/>
57<br/>
<hr/>
<a name=94></a>We&#160;now&#160;consider&#160;q(xt,&#160;xt+1|y0:t+1)&#160;to&#160;be&#160;an&#160;importance&#160;function&#160;for<br/>p(xt,&#160;xt+1|y0:t+1).&#160;The&#160;importance&#160;weight&#160;for&#160;Step&#160;2’&#160;is&#160;hence&#160;modified&#160;to:<br/>
(i)<br/>
(i)<br/>
(i)<br/>
(i)<br/>
(i)&#160;g(yt+1|x<br/>
)f&#160;(x<br/>
|x&#160;)<br/>
w<br/>
t+1<br/>
t+1<br/>
t<br/>
(26)<br/>
t+1&#160;∝&#160;wt<br/>
(i)<br/>
(i)<br/>
q(x<br/>
|x&#160;)<br/>
t+1<br/>
t<br/>
This&#160;is&#160;the&#160;general&#160;sequential&#160;importance&#160;(SIS)&#160;sampling&#160;method&#160;(Liu&#160;and<br/>
Chen,&#160;1998,&#160;Doucet,&#160;Godsill&#160;and&#160;Andrieu,&#160;2000).<br/>
58<br/>
<hr/>
<a name=95></a>We&#160;now&#160;consider&#160;q(xt,&#160;xt+1|y0:t+1)&#160;to&#160;be&#160;an&#160;importance&#160;function&#160;for<br/>p(xt,&#160;xt+1|y0:t+1).&#160;The&#160;importance&#160;weight&#160;for&#160;Step&#160;2’&#160;is&#160;hence&#160;modified&#160;to:<br/>
(i)<br/>
(i)<br/>
(i)<br/>
(i)<br/>
(i)&#160;g(yt+1|x<br/>
)f&#160;(x<br/>
|x&#160;)<br/>
w<br/>
t+1<br/>
t+1<br/>
t<br/>
(26)<br/>
t+1&#160;∝&#160;wt<br/>
(i)<br/>
(i)<br/>
q(x<br/>
|x&#160;)<br/>
t+1<br/>
t<br/>
This&#160;is&#160;the&#160;general&#160;sequential&#160;importance&#160;(SIS)&#160;sampling&#160;method&#160;(Liu&#160;and<br/>
Chen,&#160;1998,&#160;Doucet,&#160;Godsill&#160;and&#160;Andrieu,&#160;2000).<br/>
Important&#160;special&#160;cases:<br/>
•&#160;q(xt+1|xt)&#160;=&#160;f&#160;(xt+1|xt)&#160;-&#160;bootstrap&#160;filter&#160;(Gordon&#160;et&#160;al&#160;1993,&#160;Kitagawa<br/>
1996)&#160;-&#160;‘prior’&#160;sampling<br/>
•&#160;q(xt+1|xt)&#160;=&#160;p(xt+1|xt,&#160;yt+1)&#160;-&#160;sequential&#160;imputations&#160;Liu&#160;et&#160;al.&#160;1995&#160;-<br/>
optimal&#160;importance&#160;function&#160;Doucet,&#160;Godsill&#160;and&#160;Andrieu&#160;2000).<br/>
58<br/>
<hr/>
<a name=96></a>Repeated&#160;application&#160;over&#160;time&#160;(without&#160;resampling)&#160;leads&#160;to&#160;degeneracy&#160;of<br/>
the&#160;weights&#160;-&#160;all&#160;the&#160;mass&#160;becomes&#160;concentrated&#160;on&#160;a&#160;few&#160;i&#160;-&#160;hence&#160;estimates<br/>
are&#160;poor.<br/>
59<br/>
<hr/>
<a name=97></a>Repeated&#160;application&#160;over&#160;time&#160;(without&#160;resampling)&#160;leads&#160;to&#160;degeneracy&#160;of<br/>
the&#160;weights&#160;-&#160;all&#160;the&#160;mass&#160;becomes&#160;concentrated&#160;on&#160;a&#160;few&#160;i&#160;-&#160;hence&#160;estimates<br/>
are&#160;poor.<br/>
(i)<br/>
(i)<br/>
The&#160;resampling&#160;procedure&#160;(choosing&#160;x<br/>
with&#160;probability&#160;w<br/>
)&#160;alleviates<br/>
t+1<br/>
t+1<br/>
this&#160;-&#160;SIR&#160;(Gordon&#160;et&#160;al&#160;1993).<br/>
(i)<br/>
eg.&#160;Measure&#160;degeneracy&#160;by&#160;estimating&#160;the&#160;variance&#160;of&#160;w<br/>
-&#160;since&#160;reduction<br/>
t+1<br/>
(i)<br/>
in&#160;effective&#160;sample&#160;size&#160;is&#160;approximately&#160;(1+var(w<br/>
)).<br/>
t+1<br/>
59<br/>
<hr/>
<a name=98></a>A&#160;Basic&#160;Importance&#160;Sampling/Resampling&#160;Particle&#160;Filter<br/>
The&#160;first&#160;step&#160;initialises&#160;the&#160;initial&#160;states&#160;of&#160;the&#160;filter&#160;at&#160;t&#160;=&#160;0:<br/>
(i)<br/>
x<br/>
∼&#160;p(x<br/>
0<br/>
0|y0),<br/>
i&#160;=&#160;1,&#160;2,&#160;...,&#160;N<br/>
where&#160;it&#160;is&#160;assumed&#160;that&#160;this&#160;draw&#160;can&#160;be&#160;made&#160;easily&#160;(use&#160;MCMC&#160;or&#160;static<br/>
IS&#160;if&#160;not).<br/>
Then,&#160;for&#160;t=0,1,2,...<br/>
60<br/>
<hr/>
<a name=99></a>•&#160;At&#160;time&#160;t,&#160;have<br/>
N<br/>
N<br/>
X<br/>
(i)<br/>
(i)<br/>
X<br/>
(i)<br/>
p(xt|y0:t)&#160;'&#160;ˆ<br/>
p(xt|y0:t)&#160;=<br/>
w<br/>
δ(x<br/>
),<br/>
w<br/>
=&#160;1<br/>
t<br/>
t&#160;−&#160;xt<br/>
t<br/>
i=1<br/>
i=1<br/>
61<br/>
<hr/>
<a name=100></a>•&#160;At&#160;time&#160;t,&#160;have<br/>
N<br/>
N<br/>
X<br/>
(i)<br/>
(i)<br/>
X<br/>
(i)<br/>
p(xt|y0:t)&#160;'&#160;ˆ<br/>
p(xt|y0:t)&#160;=<br/>
w<br/>
δ(x<br/>
),<br/>
w<br/>
=&#160;1<br/>
t<br/>
t&#160;−&#160;xt<br/>
t<br/>
i=1<br/>
i=1<br/>
•&#160;For&#160;i&#160;=&#160;1,&#160;...,&#160;N&#160;:<br/>
(i)<br/>
(i)<br/>
x<br/>
∼&#160;q(x<br/>
)<br/>
t+1<br/>
t+1|xt<br/>
61<br/>
<hr/>
<a name=101></a>•&#160;At&#160;time&#160;t,&#160;have<br/>
N<br/>
N<br/>
X<br/>
(i)<br/>
(i)<br/>
X<br/>
(i)<br/>
p(xt|y0:t)&#160;'&#160;ˆ<br/>
p(xt|y0:t)&#160;=<br/>
w<br/>
δ(x<br/>
),<br/>
w<br/>
=&#160;1<br/>
t<br/>
t&#160;−&#160;xt<br/>
t<br/>
i=1<br/>
i=1<br/>
•&#160;For&#160;i&#160;=&#160;1,&#160;...,&#160;N&#160;:<br/>
(i)<br/>
(i)<br/>
x<br/>
∼&#160;q(x<br/>
)<br/>
t+1<br/>
t+1|xt<br/>
Update&#160;the&#160;importance&#160;weight:<br/>
(i)<br/>
(i)<br/>
(i)<br/>
(i)<br/>
(i)&#160;g(yt+1|x<br/>
)f&#160;(x<br/>
|x&#160;)<br/>
w<br/>
t+1<br/>
t+1<br/>
t<br/>
t+1&#160;∝&#160;wt<br/>
(i)<br/>
(i)<br/>
q(x<br/>
|x&#160;)<br/>
t+1<br/>
t<br/>
61<br/>
<hr/>
<a name=102></a>•&#160;At&#160;time&#160;t,&#160;have<br/>
N<br/>
N<br/>
X<br/>
(i)<br/>
(i)<br/>
X<br/>
(i)<br/>
p(xt|y0:t)&#160;'&#160;ˆ<br/>
p(xt|y0:t)&#160;=<br/>
w<br/>
δ(x<br/>
),<br/>
w<br/>
=&#160;1<br/>
t<br/>
t&#160;−&#160;xt<br/>
t<br/>
i=1<br/>
i=1<br/>
•&#160;For&#160;i&#160;=&#160;1,&#160;...,&#160;N&#160;:<br/>
(i)<br/>
(i)<br/>
x<br/>
∼&#160;q(x<br/>
)<br/>
t+1<br/>
t+1|xt<br/>
Update&#160;the&#160;importance&#160;weight:<br/>
(i)<br/>
(i)<br/>
(i)<br/>
(i)<br/>
(i)&#160;g(yt+1|x<br/>
)f&#160;(x<br/>
|x&#160;)<br/>
w<br/>
t+1<br/>
t+1<br/>
t<br/>
t+1&#160;∝&#160;wt<br/>
(i)<br/>
(i)<br/>
q(x<br/>
|x&#160;)<br/>
t+1<br/>
t<br/>
•<br/>
(i)<br/>
Optionally,&#160;resample&#160;{x<br/>
}&#160;N&#160;times&#160;with&#160;replacement&#160;using&#160;weights<br/>
t+1<br/>
(i)<br/>
(i)<br/>
w<br/>
,&#160;and&#160;then&#160;resetting&#160;w<br/>
=&#160;1/N&#160;.<br/>
t+1<br/>
t+1<br/>
61<br/>
<hr/>
<a name=103></a>The&#160;algorithm&#160;is&#160;now&#160;modified&#160;to:<br/>
For&#160;t&#160;=&#160;0,&#160;2...,&#160;T<br/>
For&#160;i&#160;=&#160;1,&#160;2,&#160;...,&#160;N<br/>
(i)<br/>
(i)<br/>
(i)<br/>
x<br/>
∼&#160;q(x<br/>
|x&#160;,&#160;y<br/>
t+1<br/>
t+1<br/>
t<br/>
0:t+1)<br/>
(i)<br/>
(i)<br/>
(i)<br/>
(i)<br/>
(i)&#160;g(y<br/>
)f&#160;(x<br/>
|x<br/>
)<br/>
w<br/>
t+1|xt+1<br/>
t+1<br/>
t<br/>
t+1&#160;∝&#160;wt<br/>
(i)<br/>
(i)<br/>
q(x<br/>
|x<br/>
,y<br/>
t+1<br/>
t<br/>
0:t+1)<br/>
End<br/>
For&#160;i&#160;=&#160;1,&#160;2,&#160;...,&#160;N<br/>
(i)<br/>
(i)<br/>
(i)<br/>
(Optional)&#160;Resample&#160;x<br/>
with&#160;probability&#160;w<br/>
.&#160;Set&#160;w<br/>
=&#160;1/N<br/>
t+1<br/>
t+1<br/>
t+1<br/>
End<br/>
End<br/>
62<br/>
<hr/>
<a name=104></a>Conclusions<br/>
•&#160;Today&#160;we&#160;covered&#160;the&#160;basic&#160;SMC&#160;algorithm&#160;and&#160;its&#160;underlying&#160;concepts:<br/>
–&#160;Bayesian&#160;Filtering<br/>
–&#160;Kalman&#160;Filter<br/>
–&#160;Bootstrap&#160;Filter&#160;and&#160;General&#160;SMC&#160;filter<br/>
•&#160;Tomorrow&#160;we&#160;cover&#160;other&#160;exotica,&#160;including:<br/>
–&#160;General&#160;SMC&#160;(part&#160;II!)<br/>
–&#160;Auxiliary&#160;particle&#160;filter<br/>
–&#160;Rao-Blackwellised&#160;particle&#160;filter<br/>
–&#160;Monte&#160;Carlo&#160;smoothing<br/>
–&#160;MCMC&#160;particle&#160;filters<br/>
–&#160;Applications.<br/>
63<br/>
<hr/>
<a name=105></a>Second&#160;part&#160;of&#160;the&#160;tutorial&#160;will&#160;cover:<br/>
•&#160;General&#160;SMC&#160;(part&#160;II!)&#160;and&#160;the&#160;Auxiliary&#160;particle&#160;filter<br/>
•&#160;Rao-Blackwellised&#160;particle&#160;filter<br/>
•&#160;Monte&#160;Carlo&#160;smoothing<br/>
•&#160;MCMC&#160;particle&#160;filters<br/>
•&#160;Applications.<br/>
[No&#160;time&#160;for&#160;details&#160;of&#160;Population&#160;Monte&#160;Carlo&#160;and&#160;Parameter&#160;estimation]<br/>
64<br/>
<hr/>
<a name=106></a>65<br/>
<hr/>
<a name=107></a>General&#160;Sequential&#160;Importance&#160;Sampling&#160;(Part&#160;II!)<br/>
Question:&#160;can&#160;we&#160;rationalise&#160;the&#160;resampling&#160;step?&#160;Why&#160;use&#160;it,&#160;and&#160;how<br/>
should&#160;it&#160;ideally&#160;be&#160;used?<br/>
Answer:&#160;yes!&#160;Make&#160;it&#160;part&#160;of&#160;the&#160;importance&#160;sampling.<br/>
66<br/>
<hr/>
<a name=108></a>General&#160;Sequential&#160;Importance&#160;Sampling&#160;(Part&#160;II!)<br/>
Question:&#160;can&#160;we&#160;rationalise&#160;the&#160;resampling&#160;step?&#160;Why&#160;use&#160;it,&#160;and&#160;how<br/>
should&#160;it&#160;ideally&#160;be&#160;used?<br/>
Answer:&#160;yes!&#160;Make&#160;it&#160;part&#160;of&#160;the&#160;importance&#160;sampling.<br/>
Consider&#160;the&#160;problem&#160;from&#160;the&#160;point&#160;of&#160;view&#160;of&#160;joint&#160;simulation&#160;from&#160;the<br/>
smoothing&#160;density.<br/>
•&#160;‘Particle’&#160;approximation&#160;to&#160;smoothing&#160;density:<br/>
N<br/>
N<br/>
X<br/>
(i)<br/>
(i)<br/>
X<br/>
(i)<br/>
p(x0:t|y0:t)&#160;'&#160;ˆ<br/>
p(x0:t|y0:t)&#160;=<br/>
w<br/>
δ(x<br/>
),<br/>
w<br/>
=&#160;1<br/>
t<br/>
0:t&#160;−&#160;x0:t<br/>
t<br/>
i=1<br/>
i=1<br/>
(i)<br/>
(i)<br/>
(i)<br/>
where&#160;w<br/>
is&#160;the&#160;‘weight’&#160;of&#160;particle&#160;x<br/>
.&#160;Note&#160;that&#160;w<br/>
will&#160;be&#160;uniform<br/>
t<br/>
0:t<br/>
t<br/>
at&#160;time&#160;steps&#160;where&#160;resampling&#160;has&#160;been&#160;carried&#160;out.<br/>
66<br/>
<hr/>
<a name=109></a>•&#160;Factorise&#160;smoothing&#160;density&#160;at&#160;t&#160;+&#160;1:<br/>
g(yt+1|xt+1)f&#160;(xt+1|xt)<br/>
p(x0:t+1|y0:t+1)&#160;=&#160;p(x0:t|y0:t)&#160;×<br/>
p(yt+1|y0:t)<br/>
67<br/>
<hr/>
<a name=110></a>•&#160;Factorise&#160;smoothing&#160;density&#160;at&#160;t&#160;+&#160;1:<br/>
g(yt+1|xt+1)f&#160;(xt+1|xt)<br/>
p(x0:t+1|y0:t+1)&#160;=&#160;p(x0:t|y0:t)&#160;×<br/>
p(yt+1|y0:t)<br/>
•&#160;Apply&#160;importance&#160;function&#160;q(x0:t+1):<br/>
g(yt+1|xt+1)f&#160;(xt+1|xt)<br/>
wt+1&#160;∝&#160;p(x0:t|y0:t)&#160;×<br/>
q(x0:t+1)<br/>
67<br/>
<hr/>
<a name=111></a>•&#160;In&#160;a&#160;sequential&#160;setting&#160;we&#160;assume&#160;that&#160;ˆ<br/>
p(x0:t|y0:t)&#160;=&#160;p(x0:t|y0:t)&#160;is&#160;the<br/>
‘truth’&#160;(the&#160;accumulation&#160;of&#160;error&#160;can&#160;be&#160;analysed)&#160;and&#160;apply&#160;an<br/>
importance&#160;function&#160;which&#160;fixes&#160;the&#160;past&#160;history&#160;of&#160;the&#160;new&#160;particles&#160;to<br/>
(i)<br/>
be&#160;one&#160;of&#160;the&#160;current&#160;particles&#160;x<br/>
.&#160;This&#160;corresponds&#160;to&#160;choosing&#160;an<br/>
0:t<br/>
importance&#160;function&#160;of&#160;the&#160;form:<br/>
N<br/>
X<br/>
(i)<br/>
q(x0:t+1)&#160;=&#160;q(xt+1|x0:t)<br/>
v<br/>
δ<br/>
(x<br/>
t<br/>
(i)<br/>
x<br/>
0:t)<br/>
0:t<br/>
i=1<br/>
68<br/>
<hr/>
<a name=112></a>•&#160;In&#160;a&#160;sequential&#160;setting&#160;we&#160;assume&#160;that&#160;ˆ<br/>
p(x0:t|y0:t)&#160;=&#160;p(x0:t|y0:t)&#160;is&#160;the<br/>
‘truth’&#160;(the&#160;accumulation&#160;of&#160;error&#160;can&#160;be&#160;analysed)&#160;and&#160;apply&#160;an<br/>
importance&#160;function&#160;which&#160;fixes&#160;the&#160;past&#160;history&#160;of&#160;the&#160;new&#160;particles&#160;to<br/>
(i)<br/>
be&#160;one&#160;of&#160;the&#160;current&#160;particles&#160;x<br/>
.&#160;This&#160;corresponds&#160;to&#160;choosing&#160;an<br/>
0:t<br/>
importance&#160;function&#160;of&#160;the&#160;form:<br/>
N<br/>
X<br/>
(i)<br/>
q(x0:t+1)&#160;=&#160;q(xt+1|x0:t)<br/>
v<br/>
δ<br/>
(x<br/>
t<br/>
(i)<br/>
x<br/>
0:t)<br/>
0:t<br/>
i=1<br/>
•&#160;Importance&#160;weights&#160;can&#160;then&#160;be&#160;computed&#160;as&#160;(see&#160;Godsill&#160;and&#160;Clapp<br/>
(2001)):<br/>
(j)<br/>
(j)<br/>
(j)<br/>
(j)<br/>
(j)<br/>
w<br/>
g(yt+1|x<br/>
)f&#160;(x<br/>
|x<br/>
)<br/>
w<br/>
t<br/>
×<br/>
t+1<br/>
t+1<br/>
t<br/>
t+1&#160;∝<br/>
(j)<br/>
(j)<br/>
(j)<br/>
v<br/>
q(x<br/>
|x<br/>
)<br/>
t<br/>
t+1<br/>
0:t<br/>
(j)<br/>
∆<br/>
(j)<br/>
(j)<br/>
where&#160;x<br/>
=&#160;(x<br/>
,&#160;x<br/>
)&#160;is&#160;the&#160;jth&#160;particle&#160;drawn&#160;from&#160;the&#160;joint<br/>
0:t+1<br/>
0:t<br/>
t+1<br/>
distribution&#160;q(x0:t+1).<br/>
68<br/>
<hr/>
<a name=113></a>•<br/>
(j)<br/>
Note&#160;the&#160;non-standard&#160;term&#160;here,&#160;v<br/>
,&#160;which&#160;serves&#160;to&#160;boost&#160;or<br/>
t<br/>
diminish&#160;the&#160;particle&#160;histories&#160;in&#160;the&#160;importance&#160;function.&#160;This&#160;weight<br/>
vt&#160;should&#160;intuitively&#160;reflect&#160;a&#160;particle’s&#160;importance&#160;at&#160;t&#160;+&#160;1,&#160;whereas&#160;its<br/>original&#160;weight&#160;wt&#160;reflects&#160;its&#160;importance&#160;at&#160;t.<br/>
69<br/>
<hr/>
<a name=114></a>•<br/>
(j)<br/>
Note&#160;the&#160;non-standard&#160;term&#160;here,&#160;v<br/>
,&#160;which&#160;serves&#160;to&#160;boost&#160;or<br/>
t<br/>
diminish&#160;the&#160;particle&#160;histories&#160;in&#160;the&#160;importance&#160;function.&#160;This&#160;weight<br/>
vt&#160;should&#160;intuitively&#160;reflect&#160;a&#160;particle’s&#160;importance&#160;at&#160;t&#160;+&#160;1,&#160;whereas&#160;its<br/>original&#160;weight&#160;wt&#160;reflects&#160;its&#160;importance&#160;at&#160;t.<br/>
•&#160;Drawing&#160;from&#160;q(x0:t)&#160;with&#160;weights&#160;vt&#160;can&#160;be&#160;interpreted&#160;as&#160;the&#160;usual<br/>
‘resampling’&#160;or&#160;‘selection’&#160;step&#160;found&#160;in&#160;particle&#160;filters.&#160;The&#160;resampling<br/>
is&#160;performed&#160;first,&#160;but&#160;this&#160;is&#160;only&#160;a&#160;conceptual&#160;difference.&#160;It&#160;can&#160;be<br/>
performed&#160;in&#160;a&#160;stratified&#160;or&#160;part-deterministic&#160;form&#160;to&#160;reduce&#160;estimator<br/>
variance.<br/>
69<br/>
<hr/>
<a name=115></a>•<br/>
(j)<br/>
Note&#160;the&#160;non-standard&#160;term&#160;here,&#160;v<br/>
,&#160;which&#160;serves&#160;to&#160;boost&#160;or<br/>
t<br/>
diminish&#160;the&#160;particle&#160;histories&#160;in&#160;the&#160;importance&#160;function.&#160;This&#160;weight<br/>
vt&#160;should&#160;intuitively&#160;reflect&#160;a&#160;particle’s&#160;importance&#160;at&#160;t&#160;+&#160;1,&#160;whereas&#160;its<br/>original&#160;weight&#160;wt&#160;reflects&#160;its&#160;importance&#160;at&#160;t.<br/>
•&#160;Drawing&#160;from&#160;q(x0:t)&#160;with&#160;weights&#160;vt&#160;can&#160;be&#160;interpreted&#160;as&#160;the&#160;usual<br/>
‘resampling’&#160;or&#160;‘selection’&#160;step&#160;found&#160;in&#160;particle&#160;filters.&#160;The&#160;resampling<br/>
is&#160;performed&#160;first,&#160;but&#160;this&#160;is&#160;only&#160;a&#160;conceptual&#160;difference.&#160;It&#160;can&#160;be<br/>
performed&#160;in&#160;a&#160;stratified&#160;or&#160;part-deterministic&#160;form&#160;to&#160;reduce&#160;estimator<br/>
variance.<br/>
•&#160;The&#160;algorithm&#160;can&#160;be&#160;written,&#160;for&#160;t&#160;=&#160;1,&#160;...,&#160;j&#160;=&#160;1,&#160;...N&#160;as:<br/>
(j)<br/>
(j)<br/>
1.&#160;Select&#160;x<br/>
with&#160;probability&#160;v<br/>
0:t<br/>
t<br/>
(j)<br/>
(j)<br/>
2.&#160;x<br/>
∼&#160;q(x<br/>
)<br/>
t+1<br/>
t+1|x0:t<br/>
(j)<br/>
(j)<br/>
(j)<br/>
(j)<br/>
(j)<br/>
w<br/>
g(y<br/>
)f&#160;(x<br/>
|x<br/>
)<br/>
3.&#160;w<br/>
t<br/>
×<br/>
t+1|xt+1<br/>
t+1<br/>
t<br/>
t+1&#160;∝<br/>
(j)<br/>
(j)<br/>
(j)<br/>
v<br/>
q(x<br/>
|x<br/>
)<br/>
t<br/>
t+1<br/>
0:t<br/>
69<br/>
<hr/>
<a name=116></a>•&#160;This&#160;formulation&#160;is&#160;of&#160;interest&#160;because&#160;it&#160;expresses&#160;several&#160;common<br/>
variants&#160;on&#160;particle&#160;filtering&#160;in&#160;one&#160;framework.&#160;In&#160;particular:<br/>
70<br/>
<hr/>
<a name=117></a>•&#160;This&#160;formulation&#160;is&#160;of&#160;interest&#160;because&#160;it&#160;expresses&#160;several&#160;common<br/>
variants&#160;on&#160;particle&#160;filtering&#160;in&#160;one&#160;framework.&#160;In&#160;particular:<br/>
(j)<br/>
(j)<br/>
–&#160;v<br/>
=&#160;w<br/>
-&#160;this&#160;corresponds&#160;to&#160;the&#160;standard&#160;SIR&#160;filtering&#160;method,<br/>
t<br/>
t<br/>
e.g.&#160;the&#160;bootstrap&#160;filter&#160;of&#160;Gordon&#160;et&#160;al.&#160;(93).&#160;Particles&#160;are<br/>
resampled&#160;according&#160;to&#160;their&#160;weight&#160;at&#160;time&#160;t.<br/>
70<br/>
<hr/>
<a name=118></a>•&#160;This&#160;formulation&#160;is&#160;of&#160;interest&#160;because&#160;it&#160;expresses&#160;several&#160;common<br/>
variants&#160;on&#160;particle&#160;filtering&#160;in&#160;one&#160;framework.&#160;In&#160;particular:<br/>
(j)<br/>
(j)<br/>
–&#160;v<br/>
=&#160;w<br/>
-&#160;this&#160;corresponds&#160;to&#160;the&#160;standard&#160;SIR&#160;filtering&#160;method,<br/>
t<br/>
t<br/>
e.g.&#160;the&#160;bootstrap&#160;filter&#160;of&#160;Gordon&#160;et&#160;al.&#160;(93).&#160;Particles&#160;are<br/>
resampled&#160;according&#160;to&#160;their&#160;weight&#160;at&#160;time&#160;t.<br/>
(j)<br/>
–&#160;v<br/>
=&#160;1/N&#160;-&#160;filter&#160;with&#160;‘no&#160;resampling’&#160;(‘sequential&#160;imputations’).&#160;In<br/>
t<br/>
practice&#160;would&#160;implement&#160;in&#160;fully&#160;stratified&#160;form&#160;by&#160;simply&#160;selecting<br/>
particles&#160;deterministically&#160;1...N&#160;.<br/>
70<br/>
<hr/>
<a name=119></a>(j)<br/>
(j)<br/>
(j)<br/>
–&#160;v<br/>
∝&#160;g(y<br/>
),&#160;where&#160;ˆ<br/>
x<br/>
is&#160;some&#160;(any!)&#160;‘estimate’&#160;of&#160;the&#160;new<br/>
t<br/>
t+1|ˆ<br/>
xt+1<br/>
t+1<br/>
state.&#160;This&#160;is&#160;the&#160;auxiliary&#160;particle&#160;filter&#160;of&#160;Pitt&#160;and&#160;Shephard<br/>
(1998).&#160;This&#160;makes&#160;use&#160;of&#160;the&#160;particle’s&#160;importance&#160;at&#160;time&#160;t&#160;+&#160;1&#160;in<br/>
an&#160;efficient&#160;way.<br/>
71<br/>
<hr/>
<a name=120></a>(j)<br/>
(j)<br/>
(j)<br/>
–&#160;v<br/>
∝&#160;g(y<br/>
),&#160;where&#160;ˆ<br/>
x<br/>
is&#160;some&#160;(any!)&#160;‘estimate’&#160;of&#160;the&#160;new<br/>
t<br/>
t+1|ˆ<br/>
xt+1<br/>
t+1<br/>
state.&#160;This&#160;is&#160;the&#160;auxiliary&#160;particle&#160;filter&#160;of&#160;Pitt&#160;and&#160;Shephard<br/>
(1998).&#160;This&#160;makes&#160;use&#160;of&#160;the&#160;particle’s&#160;importance&#160;at&#160;time&#160;t&#160;+&#160;1&#160;in<br/>
an&#160;efficient&#160;way.<br/>
–&#160;‘Fully&#160;adapted’&#160;version&#160;of&#160;auxiliary&#160;filter<br/>
Z<br/>
(j)<br/>
(j)<br/>
(j)<br/>
v<br/>
∝&#160;p(y<br/>
,&#160;y<br/>
p(y<br/>
,&#160;y<br/>
t<br/>
t+1|xt<br/>
0:t)&#160;=<br/>
t+1,&#160;xt+1|xt<br/>
0:t)dxt+1<br/>
-&#160;not&#160;generally&#160;computable.<br/>
71<br/>
<hr/>
<a name=121></a>(j)<br/>
(j)<br/>
(j)<br/>
–&#160;v<br/>
∝&#160;g(y<br/>
),&#160;where&#160;ˆ<br/>
x<br/>
is&#160;some&#160;(any!)&#160;‘estimate’&#160;of&#160;the&#160;new<br/>
t<br/>
t+1|ˆ<br/>
xt+1<br/>
t+1<br/>
state.&#160;This&#160;is&#160;the&#160;auxiliary&#160;particle&#160;filter&#160;of&#160;Pitt&#160;and&#160;Shephard<br/>
(1998).&#160;This&#160;makes&#160;use&#160;of&#160;the&#160;particle’s&#160;importance&#160;at&#160;time&#160;t&#160;+&#160;1&#160;in<br/>
an&#160;efficient&#160;way.<br/>
–&#160;‘Fully&#160;adapted’&#160;version&#160;of&#160;auxiliary&#160;filter<br/>
Z<br/>
(j)<br/>
(j)<br/>
(j)<br/>
v<br/>
∝&#160;p(y<br/>
,&#160;y<br/>
p(y<br/>
,&#160;y<br/>
t<br/>
t+1|xt<br/>
0:t)&#160;=<br/>
t+1,&#160;xt+1|xt<br/>
0:t)dxt+1<br/>
-&#160;not&#160;generally&#160;computable.<br/>
–&#160;When&#160;coupled&#160;with&#160;an&#160;unknown&#160;parameter:<br/>
Z<br/>
(i)<br/>
(j)<br/>
(j)<br/>
v<br/>
∝&#160;p(y<br/>
,&#160;y<br/>
p(y<br/>
,&#160;y<br/>
t<br/>
t+1|xt<br/>
0:t,&#160;θ)&#160;=<br/>
t+1,&#160;xt+1|θ,&#160;xt<br/>
0:t)dxt+1<br/>
(j)<br/>
,&#160;and&#160;q(xt+1|x<br/>
,&#160;θ,&#160;y<br/>
t<br/>
0:t+1)&#160;this&#160;becomes&#160;the&#160;‘reverse&#160;order&#160;sampling’<br/>
of&#160;Polson&#160;et&#160;al&#160;(U.&#160;Chicago&#160;Tech.&#160;rep.&#160;2008).&#160;Only&#160;applicable&#160;to<br/>
models&#160;where&#160;‘Gibbs&#160;sampler&#160;is&#160;available’.<br/>
71<br/>
<hr/>
<a name=122></a>Smoothing&#160;with&#160;particle&#160;filters<br/>
[Work&#160;with&#160;Arnaud&#160;Doucet,&#160;Mike&#160;West&#160;and&#160;William&#160;Fong,&#160;see&#160;Godsill,<br/>
Doucet&#160;and&#160;West&#160;JASA&#160;(2004),&#160;Fong,&#160;Godsill,&#160;Doucet&#160;and&#160;West&#160;(IEEE&#160;Tr.<br/>
SP&#160;2002)]<br/>
•&#160;It&#160;is&#160;possible&#160;to&#160;extend&#160;the&#160;particle&#160;framework&#160;to&#160;provide&#160;smoothing&#160;as<br/>
well&#160;as&#160;filtering.&#160;Smoothing&#160;is&#160;very&#160;useful&#160;in&#160;problems&#160;where&#160;batch<br/>
processing&#160;is&#160;required,&#160;or&#160;some&#160;‘lookahead’&#160;is&#160;allowable&#160;in&#160;the&#160;system.<br/>
72<br/>
<hr/>
<a name=123></a>Smoothing&#160;with&#160;particle&#160;filters<br/>
[Work&#160;with&#160;Arnaud&#160;Doucet,&#160;Mike&#160;West&#160;and&#160;William&#160;Fong,&#160;see&#160;Godsill,<br/>
Doucet&#160;and&#160;West&#160;JASA&#160;(2004),&#160;Fong,&#160;Godsill,&#160;Doucet&#160;and&#160;West&#160;(IEEE&#160;Tr.<br/>
SP&#160;2002)]<br/>
•&#160;It&#160;is&#160;possible&#160;to&#160;extend&#160;the&#160;particle&#160;framework&#160;to&#160;provide&#160;smoothing&#160;as<br/>
well&#160;as&#160;filtering.&#160;Smoothing&#160;is&#160;very&#160;useful&#160;in&#160;problems&#160;where&#160;batch<br/>
processing&#160;is&#160;required,&#160;or&#160;some&#160;‘lookahead’&#160;is&#160;allowable&#160;in&#160;the&#160;system.<br/>
•&#160;First&#160;though,&#160;note&#160;that&#160;the&#160;standard&#160;filter&#160;also&#160;gives&#160;a&#160;smoothed&#160;output<br/>
‘for&#160;free’&#160;[simply&#160;store&#160;the&#160;whole&#160;trajectory&#160;for&#160;each&#160;particle&#160;(see&#160;last<br/>
section)]:<br/>
N<br/>
N<br/>
X<br/>
(i)<br/>
(i)<br/>
X<br/>
(i)<br/>
p(x0:t|y0:t)&#160;'&#160;ˆ<br/>
p(x0:t|y0:t)&#160;=<br/>
w<br/>
δ(x<br/>
),<br/>
w<br/>
=&#160;1<br/>
t<br/>
0:t&#160;−&#160;x0:t<br/>
t<br/>
i=1<br/>
i=1<br/>
72<br/>
<hr/>
<a name=124></a>Smoothing&#160;with&#160;particle&#160;filters<br/>
[Work&#160;with&#160;Arnaud&#160;Doucet,&#160;Mike&#160;West&#160;and&#160;William&#160;Fong,&#160;see&#160;Godsill,<br/>
Doucet&#160;and&#160;West&#160;JASA&#160;(2004),&#160;Fong,&#160;Godsill,&#160;Doucet&#160;and&#160;West&#160;(IEEE&#160;Tr.<br/>
SP&#160;2002)]<br/>
•&#160;It&#160;is&#160;possible&#160;to&#160;extend&#160;the&#160;particle&#160;framework&#160;to&#160;provide&#160;smoothing&#160;as<br/>
well&#160;as&#160;filtering.&#160;Smoothing&#160;is&#160;very&#160;useful&#160;in&#160;problems&#160;where&#160;batch<br/>
processing&#160;is&#160;required,&#160;or&#160;some&#160;‘lookahead’&#160;is&#160;allowable&#160;in&#160;the&#160;system.<br/>
•&#160;First&#160;though,&#160;note&#160;that&#160;the&#160;standard&#160;filter&#160;also&#160;gives&#160;a&#160;smoothed&#160;output<br/>
‘for&#160;free’&#160;[simply&#160;store&#160;the&#160;whole&#160;trajectory&#160;for&#160;each&#160;particle&#160;(see&#160;last<br/>
section)]:<br/>
N<br/>
N<br/>
X<br/>
(i)<br/>
(i)<br/>
X<br/>
(i)<br/>
p(x0:t|y0:t)&#160;'&#160;ˆ<br/>
p(x0:t|y0:t)&#160;=<br/>
w<br/>
δ(x<br/>
),<br/>
w<br/>
=&#160;1<br/>
t<br/>
0:t&#160;−&#160;x0:t<br/>
t<br/>
i=1<br/>
i=1<br/>
72<br/>
<hr/>
<a name=125></a>•&#160;We&#160;will&#160;consider&#160;the&#160;fixed&#160;interval&#160;problem&#160;(‘batch’&#160;processing),&#160;i.e.<br/>
estimation&#160;of:<br/>
{x0,&#160;x1,&#160;x2,&#160;...&#160;,&#160;xT&#160;}&#160;from&#160;{y0,&#160;y1,&#160;y2,&#160;...&#160;,&#160;yT&#160;}<br/>
Fixed&#160;lag&#160;and&#160;other&#160;versions&#160;can&#160;be&#160;obtained&#160;by&#160;suitable&#160;modifications<br/>
to&#160;the&#160;algorithms.<br/>
73<br/>
<hr/>
<a name=126></a>•&#160;First,&#160;assume&#160;that&#160;particle&#160;filtering&#160;has&#160;been&#160;done&#160;for&#160;t&#160;=&#160;1,&#160;2,&#160;...,&#160;T&#160;,<br/>
leading&#160;to<br/>
N<br/>
X<br/>
(i)<br/>
(i)<br/>
p(xt|y0:t)&#160;'<br/>
w<br/>
δ(x<br/>
),&#160;t&#160;=&#160;0,&#160;1,&#160;2,&#160;...,&#160;T<br/>
t<br/>
t&#160;−&#160;xt<br/>
i=1<br/>
74<br/>
<hr/>
<a name=127></a>•&#160;First,&#160;assume&#160;that&#160;particle&#160;filtering&#160;has&#160;been&#160;done&#160;for&#160;t&#160;=&#160;1,&#160;2,&#160;...,&#160;T&#160;,<br/>
leading&#160;to<br/>
N<br/>
X<br/>
(i)<br/>
(i)<br/>
p(xt|y0:t)&#160;'<br/>
w<br/>
δ(x<br/>
),&#160;t&#160;=&#160;0,&#160;1,&#160;2,&#160;...,&#160;T<br/>
t<br/>
t&#160;−&#160;xt<br/>
i=1<br/>
•&#160;Now&#160;factorise&#160;the&#160;smoothing&#160;density&#160;as&#160;follows:<br/>
T<br/>
Y<br/>
p(x0:T&#160;|y0:T&#160;)&#160;=<br/>
p(xt|xt+1:T&#160;,&#160;y0:T&#160;)<br/>
t=0<br/>
where,&#160;by&#160;the&#160;assumptions&#160;of&#160;the&#160;Markov&#160;state-space&#160;model:<br/>
p(xt|xt+1:T&#160;,&#160;y0:T&#160;)&#160;∝&#160;p(xt|y0:t)f&#160;(xt+1|xt)<br/>
74<br/>
<hr/>
<a name=128></a>•&#160;First,&#160;assume&#160;that&#160;particle&#160;filtering&#160;has&#160;been&#160;done&#160;for&#160;t&#160;=&#160;1,&#160;2,&#160;...,&#160;T&#160;,<br/>
leading&#160;to<br/>
N<br/>
X<br/>
(i)<br/>
(i)<br/>
p(xt|y0:t)&#160;'<br/>
w<br/>
δ(x<br/>
),&#160;t&#160;=&#160;0,&#160;1,&#160;2,&#160;...,&#160;T<br/>
t<br/>
t&#160;−&#160;xt<br/>
i=1<br/>
•&#160;Now&#160;factorise&#160;the&#160;smoothing&#160;density&#160;as&#160;follows:<br/>
T<br/>
Y<br/>
p(x0:T&#160;|y0:T&#160;)&#160;=<br/>
p(xt|xt+1:T&#160;,&#160;y0:T&#160;)<br/>
t=0<br/>
where,&#160;by&#160;the&#160;assumptions&#160;of&#160;the&#160;Markov&#160;state-space&#160;model:<br/>
p(xt|xt+1:T&#160;,&#160;y0:T&#160;)&#160;∝&#160;p(xt|y0:t)f&#160;(xt+1|xt)<br/>
•&#160;This&#160;factorisation&#160;allows&#160;construction&#160;of&#160;an&#160;algorithm&#160;operating&#160;in&#160;the<br/>
74<br/>
<hr/>
<a name=129></a>reverse&#160;time&#160;direction&#160;t&#160;=&#160;T,&#160;T&#160;−&#160;1,&#160;...,&#160;0.<br/>
Algorithm:&#160;Particle&#160;smoother<br/>
•&#160;Draw&#160;x<br/>
eT&#160;∼&#160;p(xT&#160;|y0:T&#160;)<br/>
•&#160;For&#160;t&#160;=&#160;T&#160;−&#160;1&#160;to&#160;1:<br/>
•<br/>
(i)<br/>
(i)<br/>
(i)<br/>
Calculate&#160;w<br/>
∝&#160;w&#160;f&#160;(x<br/>
)&#160;for&#160;i&#160;=&#160;1,&#160;...,&#160;N<br/>
t|t+1<br/>
t<br/>
et+1&#160;|xt<br/>
•<br/>
(i)<br/>
(i)<br/>
Choose&#160;x<br/>
with&#160;probability&#160;w<br/>
et&#160;=&#160;xt<br/>
t|t+1<br/>
•&#160;End<br/>
75<br/>
<hr/>
<a name=130></a>reverse&#160;time&#160;direction&#160;t&#160;=&#160;T,&#160;T&#160;−&#160;1,&#160;...,&#160;0.<br/>
Algorithm:&#160;Particle&#160;smoother<br/>
•&#160;Draw&#160;x<br/>
eT&#160;∼&#160;p(xT&#160;|y0:T&#160;)<br/>
•&#160;For&#160;t&#160;=&#160;T&#160;−&#160;1&#160;to&#160;1:<br/>
•<br/>
(i)<br/>
(i)<br/>
(i)<br/>
Calculate&#160;w<br/>
∝&#160;w&#160;f&#160;(x<br/>
)&#160;for&#160;i&#160;=&#160;1,&#160;...,&#160;N<br/>
t|t+1<br/>
t<br/>
et+1&#160;|xt<br/>
•<br/>
(i)<br/>
(i)<br/>
Choose&#160;x<br/>
with&#160;probability&#160;w<br/>
et&#160;=&#160;xt<br/>
t|t+1<br/>
•&#160;End<br/>
The&#160;sequence<br/>
(x<br/>
x<br/>
x<br/>
e0&#160;,&#160;e1&#160;,&#160;...&#160;,&#160;eT&#160;)<br/>
75<br/>
<hr/>
<a name=131></a>is&#160;then&#160;an&#160;(approximate)&#160;random&#160;draw&#160;from<br/>
T<br/>
Y<br/>
p(x0:T&#160;|y0:T&#160;)&#160;=<br/>
p(xt|xt+1:T&#160;,&#160;y0:T&#160;)<br/>
t=0<br/>
76<br/>
<hr/>
<a name=132></a>Repeated&#160;application&#160;allows&#160;Monte&#160;Carlo&#160;estimation&#160;of&#160;the&#160;smoothed&#160;state<br/>
sequence.<br/>
77<br/>
<hr/>
<a name=133></a>Repeated&#160;application&#160;allows&#160;Monte&#160;Carlo&#160;estimation&#160;of&#160;the&#160;smoothed&#160;state<br/>
sequence.<br/>
Variants&#160;on&#160;the&#160;algorithm&#160;also&#160;allow&#160;MAP&#160;smoothing,&#160;see&#160;Godsill,&#160;Doucet<br/>
and&#160;West&#160;2001&#160;(Ann.&#160;Inst.&#160;St.&#160;Math.)<br/>
77<br/>
<hr/>
<a name=134></a>Repeated&#160;application&#160;allows&#160;Monte&#160;Carlo&#160;estimation&#160;of&#160;the&#160;smoothed&#160;state<br/>
sequence.<br/>
Variants&#160;on&#160;the&#160;algorithm&#160;also&#160;allow&#160;MAP&#160;smoothing,&#160;see&#160;Godsill,&#160;Doucet<br/>
and&#160;West&#160;2001&#160;(Ann.&#160;Inst.&#160;St.&#160;Math.)<br/>
You&#160;can&#160;also&#160;do&#160;marginal&#160;smoothing&#160;using&#160;similar&#160;ideas&#160;(see&#160;Hurzeler&#160;and<br/>
Kunsch&#160;(1997),&#160;Doucet,&#160;Godsill&#160;and&#160;Andrieu&#160;(2000).<br/>
77<br/>
<hr/>
<a name=135></a>Repeated&#160;application&#160;allows&#160;Monte&#160;Carlo&#160;estimation&#160;of&#160;the&#160;smoothed&#160;state<br/>
sequence.<br/>
Variants&#160;on&#160;the&#160;algorithm&#160;also&#160;allow&#160;MAP&#160;smoothing,&#160;see&#160;Godsill,&#160;Doucet<br/>
and&#160;West&#160;2001&#160;(Ann.&#160;Inst.&#160;St.&#160;Math.)<br/>
You&#160;can&#160;also&#160;do&#160;marginal&#160;smoothing&#160;using&#160;similar&#160;ideas&#160;(see&#160;Hurzeler&#160;and<br/>
Kunsch&#160;(1997),&#160;Doucet,&#160;Godsill&#160;and&#160;Andrieu&#160;(2000).<br/>
Finally,&#160;more&#160;recent&#160;developments&#160;in&#160;the&#160;area&#160;have&#160;focussed&#160;on&#160;the&#160;so-called<br/>
2-filter&#160;formula&#160;for&#160;smoothing&#160;-&#160;see&#160;recent&#160;papers&#160;by&#160;Briers,&#160;Doucet,&#160;De<br/>
Freitas,&#160;Fearnhead&#160;...<br/>
77<br/>
<hr/>
<a name=136></a><img src="./Godsill_1-136_1.jpg"/><br/>
Example&#160;-&#160;the&#160;nonlinear&#160;model<br/>
78<br/>
<hr/>
<a name=137></a><img src="./Godsill_1-137_1.jpg"/><br/>
<img src="./Godsill_1-137_2.jpg"/><br/>
<img src="./Godsill_1-137_3.jpg"/><br/>
Example&#160;-&#160;the&#160;nonlinear&#160;model<br/>
78<br/>
<hr/>
<a name=138></a><img src="./Godsill_1-138_1.jpg"/><br/>
<img src="./Godsill_1-138_2.jpg"/><br/>
<img src="./Godsill_1-138_3.jpg"/><br/>
<img src="./Godsill_1-138_4.jpg"/><br/>
79<br/>
<hr/>
<a name=139></a>Example&#160;-&#160;a&#160;nonlinear&#160;TVAR&#160;model&#160;for&#160;non-stationary&#160;speech<br/>
[Fong,&#160;Godsill,&#160;Doucet,&#160;West&#160;(IEEE&#160;Tr.&#160;SP&#160;2002)]<br/>
Signal&#160;process&#160;{zt}&#160;generated&#160;as&#160;standard&#160;Time-varying&#160;autoregression:<br/>
80<br/>
<hr/>
<a name=140></a>Example&#160;-&#160;a&#160;nonlinear&#160;TVAR&#160;model&#160;for&#160;non-stationary&#160;speech<br/>
[Fong,&#160;Godsill,&#160;Doucet,&#160;West&#160;(IEEE&#160;Tr.&#160;SP&#160;2002)]<br/>
Signal&#160;process&#160;{zt}&#160;generated&#160;as&#160;standard&#160;Time-varying&#160;autoregression:<br/>
&#160;&#160;P<br/>
!<br/>
X<br/>
f&#160;(zt|zt−1:t−P&#160;,&#160;at,&#160;σe&#160;)&#160;=&#160;N<br/>
a<br/>
t<br/>
t,izt−i,&#160;σ2<br/>
et<br/>
i=1<br/>
g(y<br/>
<br/>
t|xt,&#160;σv&#160;)&#160;=&#160;N<br/>
x<br/>
t<br/>
t,&#160;σ2<br/>
vt<br/>
80<br/>
<hr/>
<a name=141></a>Example&#160;-&#160;a&#160;nonlinear&#160;TVAR&#160;model&#160;for&#160;non-stationary&#160;speech<br/>
[Fong,&#160;Godsill,&#160;Doucet,&#160;West&#160;(IEEE&#160;Tr.&#160;SP&#160;2002)]<br/>
Signal&#160;process&#160;{zt}&#160;generated&#160;as&#160;standard&#160;Time-varying&#160;autoregression:<br/>
&#160;&#160;P<br/>
!<br/>
X<br/>
f&#160;(zt|zt−1:t−P&#160;,&#160;at,&#160;σe&#160;)&#160;=&#160;N<br/>
a<br/>
t<br/>
t,izt−i,&#160;σ2<br/>
et<br/>
i=1<br/>
g(y<br/>
<br/>
t|xt,&#160;σv&#160;)&#160;=&#160;N<br/>
x<br/>
t<br/>
t,&#160;σ2<br/>
vt<br/>
•&#160;at&#160;=&#160;(at,1,&#160;at,2,&#160;...,&#160;at,P&#160;)&#160;is&#160;the&#160;P&#160;th&#160;order&#160;AR&#160;coefficient&#160;vector<br/>
•&#160;σ2e&#160;is&#160;the&#160;innovation&#160;variance&#160;at&#160;time&#160;t.<br/>
t<br/>
•&#160;σ2v&#160;is&#160;the&#160;observation&#160;noise&#160;variance.<br/>
t<br/>
•&#160;at&#160;is&#160;assumed&#160;to&#160;evolve&#160;over&#160;time&#160;as&#160;a&#160;dynamical&#160;model.&#160;We&#160;choose&#160;a<br/>
nonlinear&#160;parameterisation&#160;based&#160;on&#160;time-varying&#160;lattice&#160;coefficients<br/>
80<br/>
<hr/>
<a name=142></a><img src="./Godsill_1-142_1.jpg"/><br/>
Figure&#160;2:&#160;Speech&#160;data.&#160;0.62s&#160;of&#160;a&#160;US&#160;male&#160;speaker&#160;saying&#160;the&#160;words<br/>
‘...rewarded&#160;by...’.&#160;Sample&#160;rate&#160;16kHz,&#160;resolution&#160;16-bit,&#160;from&#160;the<br/>
TIMIT&#160;speech&#160;database<br/>
81<br/>
<hr/>
<a name=143></a><img src="./Godsill_1-143_1.jpg"/><br/>
<img src="./Godsill_1-143_2.jpg"/><br/>
Figure&#160;3:&#160;Noisy&#160;speech,&#160;t=801,...,1000,&#160;and&#160;smoothed&#160;realisations<br/>
82<br/>
<hr/>
<a name=144></a><img src="./Godsill_1-144_1.jpg"/><br/>
<img src="./Godsill_1-144_2.jpg"/><br/>
Figure&#160;4:&#160;10&#160;realizations&#160;from&#160;the&#160;smoothing&#160;density&#160;for&#160;the&#160;TV-PARCOR<br/>
coefficients&#160;(LHS)&#160;compared&#160;with&#160;standard&#160;trajectory-based<br/>
method&#160;(RHS).<br/>
83<br/>
<hr/>
<a name=145></a>Rao-blackwellised&#160;filtering<br/>
•&#160;So&#160;far&#160;we&#160;have&#160;considered&#160;generic&#160;models&#160;without&#160;any&#160;significant<br/>
constraints&#160;on&#160;their&#160;structure.<br/>
84<br/>
<hr/>
<a name=146></a>Rao-blackwellised&#160;filtering<br/>
•&#160;So&#160;far&#160;we&#160;have&#160;considered&#160;generic&#160;models&#160;without&#160;any&#160;significant<br/>
constraints&#160;on&#160;their&#160;structure.<br/>
•&#160;What,&#160;though,&#160;if&#160;there&#160;is&#160;some&#160;analytic&#160;structure&#160;in&#160;the&#160;model,&#160;e.g.<br/>
some&#160;component&#160;of&#160;the&#160;model&#160;is&#160;linear/Gaussian,&#160;or&#160;a&#160;Hidden&#160;Markov<br/>
model&#160;(HMM)?<br/>
84<br/>
<hr/>
<a name=147></a>Rao-blackwellised&#160;filtering<br/>
•&#160;So&#160;far&#160;we&#160;have&#160;considered&#160;generic&#160;models&#160;without&#160;any&#160;significant<br/>
constraints&#160;on&#160;their&#160;structure.<br/>
•&#160;What,&#160;though,&#160;if&#160;there&#160;is&#160;some&#160;analytic&#160;structure&#160;in&#160;the&#160;model,&#160;e.g.<br/>
some&#160;component&#160;of&#160;the&#160;model&#160;is&#160;linear/Gaussian,&#160;or&#160;a&#160;Hidden&#160;Markov<br/>
model&#160;(HMM)?<br/>
•&#160;One&#160;answer&#160;is&#160;to&#160;mix&#160;the&#160;analytic&#160;filtering&#160;results&#160;of&#160;the&#160;Kalman&#160;filter<br/>
or&#160;HMM&#160;filter&#160;with&#160;the&#160;particle&#160;filter:&#160;‘Rao-Blackwellised’,&#160;‘Mixture<br/>
Kalman’&#160;or&#160;‘Marginalised’&#160;particle&#160;filter&#160;-&#160;see&#160;Doucet,&#160;Godsill&#160;and<br/>
Andrieu&#160;(2000),&#160;Chen&#160;and&#160;Liu&#160;(2000),&#160;Schon,&#160;Gustafsson,&#160;Nordlund<br/>
(2005).<br/>
84<br/>
<hr/>
<a name=148></a>Rao-blackwellised&#160;filtering<br/>
•&#160;So&#160;far&#160;we&#160;have&#160;considered&#160;generic&#160;models&#160;without&#160;any&#160;significant<br/>
constraints&#160;on&#160;their&#160;structure.<br/>
•&#160;What,&#160;though,&#160;if&#160;there&#160;is&#160;some&#160;analytic&#160;structure&#160;in&#160;the&#160;model,&#160;e.g.<br/>
some&#160;component&#160;of&#160;the&#160;model&#160;is&#160;linear/Gaussian,&#160;or&#160;a&#160;Hidden&#160;Markov<br/>
model&#160;(HMM)?<br/>
•&#160;One&#160;answer&#160;is&#160;to&#160;mix&#160;the&#160;analytic&#160;filtering&#160;results&#160;of&#160;the&#160;Kalman&#160;filter<br/>
or&#160;HMM&#160;filter&#160;with&#160;the&#160;particle&#160;filter:&#160;‘Rao-Blackwellised’,&#160;‘Mixture<br/>
Kalman’&#160;or&#160;‘Marginalised’&#160;particle&#160;filter&#160;-&#160;see&#160;Doucet,&#160;Godsill&#160;and<br/>
Andrieu&#160;(2000),&#160;Chen&#160;and&#160;Liu&#160;(2000),&#160;Schon,&#160;Gustafsson,&#160;Nordlund<br/>
(2005).<br/>
•&#160;Split&#160;the&#160;state&#160;vector&#160;into&#160;two&#160;parts&#160;xL&#160;(‘good&#160;cop’)&#160;and&#160;xN&#160;(‘bad&#160;cop’)<br/>
84<br/>
<hr/>
<a name=149></a>•&#160;The&#160;‘good’&#160;part&#160;of&#160;the&#160;state,&#160;xL<br/>
t&#160;,&#160;can&#160;be&#160;written&#160;as&#160;a&#160;linear&#160;state&#160;space<br/>
model:<br/>
xL<br/>
t&#160;=&#160;A(xN<br/>
t&#160;)xL<br/>
t−1&#160;+&#160;uL<br/>
t&#160;,<br/>
(27)<br/>
yt&#160;=&#160;B(xN<br/>
t&#160;)xL<br/>
t&#160;+&#160;vL<br/>
t&#160;.<br/>
(28)<br/>
Here&#160;uL<br/>
t&#160;and&#160;vL<br/>
t<br/>
are&#160;independent,&#160;zero-mean,&#160;Gaussian&#160;disturbances<br/>
with&#160;covariances&#160;Cu&#160;and&#160;Cv,&#160;respectively.&#160;nonlinear&#160;state&#160;xN<br/>
t&#160;.<br/>
85<br/>
<hr/>
<a name=150></a>•&#160;The&#160;‘good’&#160;part&#160;of&#160;the&#160;state,&#160;xL<br/>
t&#160;,&#160;can&#160;be&#160;written&#160;as&#160;a&#160;linear&#160;state&#160;space<br/>
model:<br/>
xL<br/>
t&#160;=&#160;A(xN<br/>
t&#160;)xL<br/>
t−1&#160;+&#160;uL<br/>
t&#160;,<br/>
(27)<br/>
yt&#160;=&#160;B(xN<br/>
t&#160;)xL<br/>
t&#160;+&#160;vL<br/>
t&#160;.<br/>
(28)<br/>
Here&#160;uL<br/>
t&#160;and&#160;vL<br/>
t<br/>
are&#160;independent,&#160;zero-mean,&#160;Gaussian&#160;disturbances<br/>
with&#160;covariances&#160;Cu&#160;and&#160;Cv,&#160;respectively.&#160;nonlinear&#160;state&#160;xN<br/>
t&#160;.<br/>
•&#160;Now&#160;the&#160;‘bad’&#160;nonlinear&#160;part&#160;of&#160;the&#160;state&#160;obeys&#160;a&#160;general&#160;dynamical<br/>
model:<br/>
xN&#160;∼<br/>
|<br/>
∼<br/>
t<br/>
f&#160;(xN<br/>
t<br/>
xN<br/>
0:t−1),<br/>
xN<br/>
0<br/>
f&#160;(xN<br/>
0&#160;)&#160;.<br/>
(29)<br/>
85<br/>
<hr/>
<a name=151></a>•&#160;The&#160;idea&#160;is&#160;now&#160;to&#160;marginalise&#160;the&#160;linear&#160;state&#160;sequence:&#160;the<br/>
calculations&#160;can&#160;be&#160;done&#160;exactly&#160;and&#160;sequentially&#160;by&#160;the&#160;Kalman&#160;filter<br/>
likelihood&#160;evaluation!<br/>
Z<br/>
p(xN&#160;|<br/>
|<br/>
0:t&#160;y0:t)&#160;=<br/>
p(xL<br/>
0:t,&#160;xN<br/>
0:t&#160;y0:t)dxL<br/>
0:t&#160;.<br/>
86<br/>
<hr/>
<a name=152></a>•&#160;The&#160;idea&#160;is&#160;now&#160;to&#160;marginalise&#160;the&#160;linear&#160;state&#160;sequence:&#160;the<br/>
calculations&#160;can&#160;be&#160;done&#160;exactly&#160;and&#160;sequentially&#160;by&#160;the&#160;Kalman&#160;filter<br/>
likelihood&#160;evaluation!<br/>
Z<br/>
p(xN&#160;|<br/>
|<br/>
0:t&#160;y0:t)&#160;=<br/>
p(xL<br/>
0:t,&#160;xN<br/>
0:t&#160;y0:t)dxL<br/>
0:t&#160;.<br/>
•&#160;Particle&#160;filtering&#160;is&#160;then&#160;run&#160;on&#160;the&#160;nonlinear&#160;state&#160;sequence&#160;only.<br/>
–&#160;Prediction<br/>
p(xN&#160;|<br/>
|<br/>
|<br/>
0:t&#160;y0:t−1)&#160;=&#160;p(xN<br/>
0:t−1&#160;y0:t−1)f&#160;(xN<br/>
t<br/>
xN<br/>
0:t−1)&#160;.<br/>
–&#160;Correction<br/>
p(yt|y0:t−1,&#160;xN&#160;)p(xN&#160;|y0:t−1)<br/>
p(xN&#160;|<br/>
0:t<br/>
0:t<br/>
0:t&#160;y0:t)&#160;=<br/>
,<br/>
p(yt|y0:t−1)<br/>
86<br/>
<hr/>
<a name=153></a>•&#160;{<br/>
N,(i)<br/>
(i)<br/>
(x<br/>
,&#160;ω<br/>
)}<br/>
0:t<br/>
t<br/>
i=1,...,N&#160;denote&#160;the&#160;nonlinear&#160;state&#160;particles.&#160;Then,<br/>
Rao-Blackwellised&#160;estimation&#160;scheme&#160;for&#160;xL&#160;is&#160;obtained&#160;as&#160;a&#160;random<br/>
Gaussian&#160;mixture&#160;approximation&#160;given&#160;by<br/>
N<br/>
X<br/>
(i)<br/>
N,(i)<br/>
p(xL|<br/>
|<br/>
t&#160;y0:t)&#160;≈<br/>
ω<br/>
p(xL&#160;x<br/>
,&#160;y<br/>
t<br/>
t<br/>
0:t<br/>
0:t)&#160;,<br/>
(30)<br/>
i=1<br/>
N,(i)<br/>
where&#160;the&#160;conditional&#160;densities&#160;p(xL|<br/>
t&#160;x<br/>
,&#160;y<br/>
0:t<br/>
0:t)&#160;are&#160;Gaussian&#160;and<br/>
computed&#160;using&#160;Kalman&#160;filtering&#160;recursions&#160;(likelihood&#160;evaluation).<br/>
87<br/>
<hr/>
<a name=154></a>•&#160;{<br/>
N,(i)<br/>
(i)<br/>
(x<br/>
,&#160;ω<br/>
)}<br/>
0:t<br/>
t<br/>
i=1,...,N&#160;denote&#160;the&#160;nonlinear&#160;state&#160;particles.&#160;Then,<br/>
Rao-Blackwellised&#160;estimation&#160;scheme&#160;for&#160;xL&#160;is&#160;obtained&#160;as&#160;a&#160;random<br/>
Gaussian&#160;mixture&#160;approximation&#160;given&#160;by<br/>
N<br/>
X<br/>
(i)<br/>
N,(i)<br/>
p(xL|<br/>
|<br/>
t&#160;y0:t)&#160;≈<br/>
ω<br/>
p(xL&#160;x<br/>
,&#160;y<br/>
t<br/>
t<br/>
0:t<br/>
0:t)&#160;,<br/>
(30)<br/>
i=1<br/>
N,(i)<br/>
where&#160;the&#160;conditional&#160;densities&#160;p(xL|<br/>
t&#160;x<br/>
,&#160;y<br/>
0:t<br/>
0:t)&#160;are&#160;Gaussian&#160;and<br/>
computed&#160;using&#160;Kalman&#160;filtering&#160;recursions&#160;(likelihood&#160;evaluation).<br/>
•<br/>
N,(i)<br/>
N,(i)<br/>
Since&#160;p(xL|<br/>
t&#160;x<br/>
,&#160;y<br/>
,&#160;the&#160;Kalman&#160;filter<br/>
0:t<br/>
0:t)&#160;depends&#160;on&#160;the&#160;particle&#160;x0:t<br/>
must&#160;be&#160;run&#160;for&#160;every&#160;particle&#160;-&#160;very&#160;expensive&#160;-<br/>
performance/computation&#160;trade-off.<br/>
87<br/>
<hr/>
<a name=155></a>Example:&#160;Heavy-tailed&#160;noise&#160;modelling<br/>
Lombardi&#160;and&#160;Godsill&#160;(IEEE&#160;Tr&#160;SP&#160;2006)<br/>
•&#160;One&#160;of&#160;the&#160;empirical&#160;features&#160;of&#160;noise&#160;in&#160;many&#160;audio&#160;sources<br/>
(gramophone&#160;disks,&#160;...)&#160;is&#160;heavy-tailed&#160;behaviour&#160;(clicks,&#160;crackles...).<br/>
•&#160;We&#160;will&#160;consider&#160;on-line&#160;estimation&#160;and&#160;signal&#160;extraction&#160;in&#160;heavy-tailed<br/>
α-stable&#160;law&#160;noise&#160;models&#160;by&#160;means&#160;of&#160;sequential&#160;Monte&#160;Carlo&#160;methods.<br/>
88<br/>
<hr/>
<a name=156></a>α-Stable&#160;Distributions<br/>
•&#160;The&#160;α-stable&#160;family&#160;of&#160;distributions&#160;stems&#160;from&#160;a&#160;generalised&#160;general<br/>
version&#160;of&#160;the&#160;central&#160;limit&#160;theorem&#160;in&#160;which&#160;the&#160;assumption&#160;of&#160;the<br/>
finiteness&#160;of&#160;the&#160;variance&#160;is&#160;replaced&#160;by&#160;a&#160;much&#160;less&#160;restrictive&#160;one<br/>
concerning&#160;the&#160;regular&#160;behaviour&#160;of&#160;the&#160;tails.<br/>
•&#160;The&#160;family&#160;is&#160;identified&#160;by&#160;means&#160;of&#160;the&#160;characteristic&#160;function<br/>
<br/>
<br/>
exp&#160;{iδt&#160;−&#160;γα|t|α&#160;[1&#160;−&#160;iβsgn](t)&#160;tan(πα/2)]}<br/>
if&#160;α&#160;6=&#160;1<br/>
φ(t)&#160;=<br/>
(31)<br/>
<br/>
exp&#160;iδt&#160;−&#160;γ|t|&#160;1&#160;+&#160;iβ&#160;2&#160;sgn(t)&#160;ln&#160;|t|	<br/>
if&#160;α&#160;=&#160;1<br/>
π<br/>
which&#160;depends&#160;on&#160;four&#160;parameters:&#160;α&#160;∈&#160;(0,&#160;2],&#160;measuring&#160;the&#160;tail<br/>
thickness&#160;(thicker&#160;tails&#160;for&#160;smaller&#160;values&#160;of&#160;the&#160;parameter),&#160;β&#160;∈&#160;[−1,&#160;1]<br/>
determining&#160;the&#160;degree&#160;and&#160;sign&#160;of&#160;asymmetry,&#160;γ&#160;&gt;&#160;0&#160;(scale)&#160;and&#160;δ&#160;∈&#160;&lt;<br/>
(location).<br/>
89<br/>
<hr/>
<a name=157></a>•&#160;Unfortunately,&#160;<a href="Godsill_1s.html#156">(31)&#160;</a>can&#160;be&#160;inverted&#160;to&#160;yield&#160;a&#160;closed-form&#160;density<br/>
function&#160;only&#160;for&#160;a&#160;very&#160;few&#160;cases&#160;(Gaussian,&#160;Cauchy,&#160;Levy).<br/>
•&#160;Estimation&#160;difficulties&#160;have&#160;thus&#160;hindered&#160;the&#160;use&#160;of&#160;α-stable<br/>
distributions&#160;in&#160;applied&#160;work.<br/>
•&#160;Here&#160;we&#160;propose&#160;sequential&#160;Monte&#160;Carlo&#160;method&#160;for&#160;extraction&#160;of<br/>
TVAR&#160;time&#160;series&#160;observed&#160;in&#160;symmetric&#160;α-stable&#160;noise&#160;(β&#160;=&#160;0).<br/>
•&#160;By&#160;representing&#160;the&#160;symmetric&#160;stable&#160;law&#160;as&#160;a&#160;scale&#160;mixture&#160;of<br/>
Gaussians,&#160;the&#160;Monte&#160;Carlo&#160;approach&#160;avoids&#160;any&#160;direct&#160;evaluations&#160;of<br/>
the&#160;stable&#160;law&#160;pdf.<br/>
90<br/>
<hr/>
<a name=158></a><img src="./Godsill_1-158_1.jpg"/><br/>
Figure&#160;5:&#160;Waveform&#160;and&#160;histogram&#160;of&#160;noise&#160;from&#160;gramophone&#160;sound<br/>
recording.<br/>
91<br/>
<hr/>
<a name=159></a><img src="./Godsill_1-159_1.jpg"/><br/>
Figure&#160;6:&#160;Kernel&#160;density&#160;(solid&#160;line),&#160;Gaussian&#160;fit&#160;(grey&#160;line),&#160;Student&#160;t&#160;fit<br/>
(dashed&#160;line)&#160;and&#160;α-stable&#160;fit&#160;(dotted&#160;line).<br/>
92<br/>
<hr/>
<a name=160></a>•&#160;In&#160;the&#160;case&#160;of&#160;symmetric&#160;stable&#160;distributions&#160;we&#160;can&#160;exploit&#160;the&#160;fact<br/>
that,&#160;if&#160;we&#160;have&#160;two&#160;random&#160;variables<br/>
X1&#160;∼&#160;St(α1,&#160;0),<br/>
X2&#160;∼&#160;St(α2,&#160;1),<br/>
then&#160;the&#160;distribution&#160;of&#160;their&#160;product&#160;is<br/>
X1X2&#160;∼&#160;St(α1α2,&#160;0).<br/>
•&#160;It&#160;follows&#160;that&#160;a&#160;symmetric&#160;α-stable&#160;random&#160;variable&#160;can&#160;be&#160;thought&#160;of<br/>
as&#160;the&#160;product&#160;of&#160;a&#160;Gaussian&#160;X1&#160;and&#160;a&#160;perfectly&#160;skewed&#160;stable&#160;random<br/>variable:<br/>
X2&#160;∼&#160;St&#160;α&#160;,&#160;1&#160;.<br/>
2<br/>
•&#160;Hence&#160;a&#160;conditionally&#160;Gaussian&#160;particle&#160;filter&#160;may&#160;be&#160;implemented,<br/>
allowing&#160;Rao-Blackwellisation&#160;(Kalman&#160;filter)&#160;-&#160;see&#160;Vermaak,&#160;Andrieu,<br/>
Doucet&#160;and&#160;Godsill&#160;(IEEE&#160;SA,&#160;2002)&#160;for&#160;the&#160;Gaussian&#160;noise&#160;case.<br/>
93<br/>
<hr/>
<a name=161></a><img src="./Godsill_1-161_1.jpg"/><br/>
94<br/>
<hr/>
<a name=162></a><img src="./Godsill_1-162_1.jpg"/><br/>
Figure&#160;7:&#160;Filtered&#160;signal&#160;(solid&#160;line)&#160;with&#160;95%&#160;quantile&#160;bands&#160;(dotted&#160;lines),<br/>
stable&#160;noise,&#160;α&#160;=&#160;1.4.<br/>
95<br/>
<hr/>
<a name=163></a><img src="./Godsill_1-163_1.jpg"/><br/>
Figure&#160;8:&#160;Estimated&#160;parameters&#160;of&#160;the&#160;model,&#160;stable&#160;noise.<br/>
96<br/>
<hr/>
<a name=164></a><img src="./Godsill_1-164_1.jpg"/><br/>
Figure&#160;9:&#160;Kernel&#160;smoothed&#160;posterior&#160;densities&#160;of&#160;α&#160;in&#160;for&#160;t&#160;=&#160;150,&#160;.&#160;.&#160;.&#160;,&#160;200.<br/>
97<br/>
<hr/>
<a name=165></a><img src="./Godsill_1-165_1.jpg"/><br/>
Figure&#160;10:&#160;Excerpt&#160;of&#160;clean,&#160;noisy&#160;and&#160;reconstructed&#160;signal&#160;for&#160;Boards&#160;of<br/>
Canada’s&#160;“Music&#160;is&#160;Math”.<br/>
98<br/>
<hr/>
<a name=166></a>Non-linear&#160;distortion&#160;correction<br/>
[Work&#160;with&#160;William&#160;Fong&#160;(2002)]<br/>
Model&#160;the&#160;observation&#160;process&#160;as&#160;a&#160;Gaussian-limited&#160;dependent&#160;process:<br/>
yt&#160;=&#160;F&#160;(zt)<br/>
(32)<br/>
with&#160;F&#160;(·)&#160;being&#160;a&#160;general&#160;distortion&#160;function.<br/>
The&#160;inverse&#160;process,<br/>
F&#160;−1(yt)&#160;=&#160;{zt;&#160;F(zt)&#160;=&#160;yt}<br/>
(33)<br/>
is&#160;a&#160;one-to-many&#160;mapping&#160;and&#160;provides&#160;a&#160;range&#160;of&#160;possible&#160;values&#160;that&#160;the<br/>
input&#160;might&#160;have&#160;taken.&#160;In&#160;terms&#160;of&#160;probability&#160;distributions,<br/>
p(yt|zt)&#160;=&#160;δ(yt&#160;−&#160;F&#160;(zt))<br/>
As&#160;before,&#160;{zt}&#160;is&#160;modelled&#160;as&#160;a&#160;TVAR&#160;process,&#160;this&#160;time&#160;using&#160;the&#160;standard<br/>linear&#160;random&#160;walk&#160;paramerisation&#160;of&#160;the&#160;coeffs.<br/>
99<br/>
<hr/>
<a name=167></a><img src="./Godsill_1-167_1.jpg"/><br/>
Figure&#160;11:&#160;Many-to-one&#160;mapping&#160;for&#160;quantised&#160;signal<br/>
100<br/>
<hr/>
<a name=168></a><img src="./Godsill_1-168_1.jpg"/><br/>
Figure&#160;12:&#160;Many-to-one&#160;mapping&#160;for&#160;clipped&#160;signal<br/>
101<br/>
<hr/>
<a name=169></a>With&#160;these&#160;models,&#160;the&#160;TVAR&#160;parameters&#160;may&#160;be&#160;marginalised&#160;completely,<br/>
i.e.&#160;we&#160;sample&#160;from:<br/>
Z<br/>
p(z1:T&#160;|y1:T&#160;)&#160;=<br/>
p(z1:T&#160;,&#160;a1:T&#160;|y1:T&#160;)da1:T<br/>
[In&#160;the&#160;filtering&#160;case,&#160;this&#160;was&#160;demonstrated&#160;previously&#160;by&#160;Andrieu&#160;and<br/>
Doucet&#160;(2002,&#160;JRSSB)].<br/>
The&#160;required&#160;backward&#160;conditional&#160;density&#160;function&#160;is&#160;then&#160;given&#160;by<br/>
N<br/>
Z<br/>
X<br/>
(i)<br/>
(i)<br/>
p(zt|zt+1:T&#160;,&#160;y1:T&#160;)&#160;≈<br/>
p(zt+1|z1:t)<br/>
w<br/>
δ(z<br/>
)dz<br/>
t<br/>
1:t&#160;−&#160;z1:t<br/>
1:t−1<br/>
i=1<br/>
N<br/>
X<br/>
≈<br/>
(i)<br/>
(i)<br/>
(i)<br/>
w<br/>
p(z<br/>
)δ(z<br/>
)<br/>
t<br/>
t+1|z1:t<br/>
t&#160;−&#160;z1:t<br/>
i=1<br/>
N<br/>
X<br/>
≈<br/>
(i)<br/>
(i)<br/>
w<br/>
δ(z<br/>
)<br/>
t|t+1<br/>
t&#160;−&#160;zt<br/>
i=1<br/>
102<br/>
<hr/>
<a name=170></a><img src="./Godsill_1-170_1.jpg"/><br/>
<img src="./Godsill_1-170_2.jpg"/><br/>
(i)<br/>
(i)<br/>
(i)<br/>
with&#160;the&#160;modified&#160;weight&#160;w<br/>
∝&#160;w&#160;p(z<br/>
).&#160;This&#160;weight&#160;is&#160;computed<br/>
t|t+1<br/>
t<br/>
t+1|z1:t<br/>
sequentially&#160;by&#160;sequential&#160;computation&#160;of&#160;the&#160;sufficient&#160;statistics&#160;(Kalman<br/>
filter)&#160;and&#160;the&#160;prediction&#160;error&#160;decomposition.<br/>
(a)&#160;Generic&#160;particle&#160;smoother&#160;(b)&#160;Rao-Blackwellised&#160;particle<br/>
smoother<br/>
Figure&#160;13:&#160;Typical&#160;frame&#160;showing&#160;the&#160;original,&#160;quantised&#160;and&#160;simulated<br/>
trajectories&#160;generated&#160;using&#160;different&#160;non-linear&#160;smoothers<br/>
103<br/>
<hr/>
<a name=171></a><img src="./Godsill_1-171_1.jpg"/><br/>
<img src="./Godsill_1-171_2.jpg"/><br/>
(a)&#160;Generic&#160;particle&#160;smoother&#160;(b)&#160;Rao-Blackwellised&#160;particle<br/>
smoother<br/>
Figure&#160;14:&#160;Typical&#160;frame&#160;showing&#160;the&#160;original,&#160;clipped&#160;and&#160;simulated<br/>
trajectories&#160;generated&#160;using&#160;different&#160;non-linear&#160;smoothers<br/>
104<br/>
<hr/>
<a name=172></a><img src="./Godsill_1-172_1.jpg"/><br/>
105<br/>
Figure&#160;15:&#160;Average&#160;output&#160;SNR&#160;for&#160;different&#160;algorithms&#160;given&#160;a&#160;heavily<br/>
corrupted&#160;(SNRin&#160;=&#160;−1.42dB)&#160;observation<br/>
<hr/>
<a name=173></a><img src="./Godsill_1-173_1.jpg"/><br/>
106<br/>
Figure&#160;16:&#160;Average&#160;output&#160;SNR&#160;for&#160;different&#160;algorithms&#160;given&#160;a&#160;lightly<br/>
corrupted&#160;(SNRin&#160;=&#160;18.58dB)&#160;observation<br/>
<hr/>
<a name=174></a>MCMC&#160;and&#160;particle&#160;filters<br/>
•&#160;A&#160;powerful&#160;combination&#160;is&#160;particle&#160;filters&#160;with&#160;MCMC<br/>
•&#160;There&#160;are&#160;two&#160;principal&#160;schemes:<br/>
•&#160;–&#160;We&#160;have,&#160;approximately,&#160;after&#160;resampling&#160;in&#160;the&#160;importance<br/>
sampling&#160;filter:<br/>
(i)<br/>
x<br/>
)&#160;∼&#160;p(x<br/>
0:t<br/>
0:t|y0:t)<br/>
–&#160;Apply&#160;an&#160;MCMC&#160;kernel&#160;with&#160;p(x0:t|y0:t)&#160;as&#160;target&#160;density,&#160;e.g.<br/>
fixed-lag&#160;Gibbs-MH&#160;moves&#160;on&#160;p(xt−L+1:t|x0:t−L,&#160;y0:t).&#160;Intuition&#160;is<br/>that&#160;as&#160;the&#160;MCMC&#160;converges&#160;the&#160;particle&#160;representation&#160;will<br/>
‘improve’.&#160;No&#160;need&#160;to&#160;diagnose&#160;convergence&#160;of&#160;chains...<br/>
–&#160;This&#160;is&#160;is&#160;the&#160;‘resample-move’&#160;scheme&#160;-&#160;Berzuini&#160;and&#160;Gilks&#160;(1998),<br/>
see&#160;also&#160;MacEachern,&#160;Clyde&#160;and&#160;Liu&#160;(1997)<br/>
–&#160;Generally&#160;very&#160;effective,&#160;but&#160;does&#160;not&#160;remove&#160;the&#160;importance<br/>
sampling&#160;element.<br/>
107<br/>
<hr/>
<a name=175></a>•&#160;–&#160;Instead,&#160;recall&#160;that&#160;the&#160;SMC&#160;scheme&#160;approximates&#160;the&#160;filtering<br/>
recursions&#160;as&#160;follows:<br/>
(i)<br/>
1&#160;g(yt+1|xt+1)&#160;PN&#160;f&#160;(x<br/>
)δ<br/>
(x<br/>
i=1<br/>
t+1|xt<br/>
(i)<br/>
x<br/>
0:t)<br/>
p(x<br/>
0:t<br/>
0:t+1|y0:t+1)&#160;≈&#160;N<br/>
p(yt+1|y1:t)<br/>
or,&#160;equivalently&#160;(integrate&#160;over&#160;x0:t):<br/>
(i)<br/>
1&#160;g(yt+1|xt+1)&#160;PN&#160;f&#160;(xt+1|x&#160;)<br/>
p(x<br/>
i=1<br/>
t<br/>
t+1|y0:t+1)&#160;≈&#160;N<br/>
p(yt+1|y1:t)<br/>
–&#160;We&#160;can&#160;run&#160;MCMC&#160;directly&#160;on&#160;either&#160;of&#160;these&#160;target&#160;distributions&#160;to<br/>
replace&#160;the&#160;importance&#160;sampler&#160;altogether&#160;-&#160;this&#160;is&#160;done&#160;in&#160;Gilks&#160;et<br/>
al&#160;(1997,&#160;JASA)&#160;and&#160;Khan,&#160;Balcher&#160;and&#160;Dellaert&#160;(2006,&#160;PAMI).<br/>
–&#160;Very&#160;effective&#160;schemes&#160;-&#160;can&#160;incorporater&#160;Gibbs&#160;moves,&#160;joint&#160;MH<br/>
moves&#160;-&#160;all&#160;the&#160;power&#160;of&#160;MCMC.<br/>
108<br/>
<hr/>
<a name=176></a>Discussion<br/>
•&#160;The&#160;particle&#160;filter/smoother&#160;plus&#160;its&#160;adaptations,&#160;make&#160;a&#160;powerful,<br/>
computationally&#160;intensive,&#160;suite&#160;of&#160;methods&#160;for&#160;inference&#160;in&#160;large<br/>
datasets.<br/>
•&#160;We&#160;have&#160;covered&#160;most&#160;of&#160;the&#160;basics.&#160;Pointers&#160;to&#160;other&#160;areas,&#160;especially:<br/>
–&#160;Parameter&#160;estimation&#160;-&#160;on-going&#160;challenge<br/>
–&#160;Population&#160;Monte&#160;Carlo/&#160;SMC&#160;samplers&#160;-&#160;hot&#160;topic<br/>
can&#160;be&#160;found&#160;in&#160;our&#160;review&#160;paper:<br/>
Capp´<br/>
e,&#160;Godsill&#160;and&#160;Moulines,&#160;Proc.&#160;IEEE&#160;2007<br/>
109<br/>
<hr/>
<a name=177></a><img src="./Godsill_1-177_1.png"/><br/>
<img src="./Godsill_1-177_2.png"/><br/>
<img src="./Godsill_1-177_3.png"/><br/>
References<br/>
110<br/>
<hr/>
</body>
</html>
